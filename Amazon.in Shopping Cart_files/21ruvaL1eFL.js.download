(function(k){var d=window.AmazonUIPageJS||window.P,l=d._namespace||d.attributeErrors,c=l?l("CheckoutCartPrefetchAsset",""):d;c.guardFatal?c.guardFatal(k)(c,window):c.execute(function(){k(c,window)})})(function(k,d,l){k.when("A","CartServerSetting","CartCheckoutPrefetch-DeviceAgnosticFunctions").register("CartCheckoutPrefetchDesktop",function(c,l,h){function p(){return"/gp/buy/prefetch/store-html.html"}function g(){var c=(new Date).getTime(),d="/gp/cart/checkout-prefetch.html?cartInitiateId\x3d"+c,
g=h.getBuyBoxParameters(m),f;for(f in g)g.hasOwnProperty(f)&&(d+="\x26"+f+"\x3d"+encodeURIComponent(g[f]));h.streamJSONPrefetchRequest(d,"PreInitiate:",h.executionIdSuccessHandler,c);h.insertValueInBuyBox("cartInitiateId",c)}function n(c){function g(){5>r&&(h.fireAndForgetPrefetchRequest(c,"StoreHtml:"),r++,q=setTimeout(g,6E4))}f(d).ready(function(){q=setTimeout(g,6E4)})}var f=c.$,m=["partialCheckoutCart"],q,r=0;k.when("total-purchase-cost-prefetch-listeners").register("setupCartCheckoutPrefetch",
function(){var d=!1,h=!1;c.on("sc:checkout-prefetch:start",function(){d=!0});c.on("sc:checkout-prefetch:complete",function(){d=!1;h&&f("#sc-buy-box form").submit()});f(document).delegate("#sc-buy-box form","submit",function(c){return d?(h=!0,c.preventDefault(),!1):!0});g();n(p());c.declarative("sc-buy-box-gift-checkbox-update","click",function(c){!1===c.$target[0].checked&&g()});c.on("sc:checkout-prefetch",function(){clearTimeout(q);g();n(p())});c.on("affordability:clipCoupon:success",function(){l.features.enableCheckoutPrefetchForCouponClipping&&
g()})})});"use strict";k.when("A","CartServerSetting").register("CartCheckoutPrefetch-DeviceAgnosticFunctions",function(c,k){function h(a,b){c.trigger("sc:checkout-prefetch:start",{prefetchPromise:a});b&&(v=b)}function p(a){c.trigger("sc:checkout-prefetch:complete",a)}function g(a,b){"undefined"!==typeof d.ue&&"undefined"!==typeof d.ue.count&&d.ue.count(a,b||1)}function n(){var a=document.getElementById("sc-buy-box");if(a&&(a=a.getElementsByTagName("form"),0!==a.length))return a[0]}function f(a,b){var c=
n();if(c){m(c,a);var e=document.createElement("input");e.setAttribute("type","hidden");e.setAttribute("value",b);e.setAttribute("name",a);c.appendChild(e)}}function m(a,c){if(a)for(var b=a.getElementsByTagName("input"),e=0;e<b.length;e++)b[e].name===c&&a.removeChild(b[e])}function q(){var a=n();a&&(m(a,"preInitiateExecutionId"),m(a,"preInitiatePurchaseId"),m(a,"isJavaPreinitiate"))}function r(){clearTimeout(w)}function x(a,c,f,e){var b={"x-amzn-tiertwo":"yes"};"javaCheckoutPreInitiate:"===c&&(b["x-amz-checkout-transition"]=
"ajax");a=fetch(a,{headers:b}).then(function(a){var b=a.body.pipeThrough(new TextDecoderStream).getReader(),d="";return b.read().then(function y(a){if(a.done){if(""===d.trim())return g(c+"prefetch_ajax_streaming_nodata",1),null;throw Error("Could not read JSON data from prefetch endpoint");}d+=a.value;try{var h=JSON.parse(d)}catch(z){return b.read().then(y)}f&&f(h,e);g(c+"prefetch_ajax_streaming_success",1);return h})}).catch(function(a){var b={message:"streamJSONUsingFetch failed"};d.ueLogError&&
(b=b||{},b.logLevel=b.logLevel||"ERROR",b.attribution=b.attribution||"CheckoutCartPrefetchAsset: Website \x3e Amazon Checkout Pipeline \x3e Others",b.message=b.message||"",d.ueLogError(a,b));g(c+"prefetch_ajax_streaming_error",1);return null}).then(function(a){p(a);return a});h(a,e);return a}function t(a,b,d,e){var f={"x-amzn-tiertwo":"yes"};"javaCheckoutPreInitiate:"===b&&(f["x-amz-checkout-transition"]="ajax");a=c.$.ajax(a.toString(),{headers:f,success:function(a,c,f){d&&d(a,e);g(b+"prefetch_ajax_jquery_success",
1);p(a);return a},error:function(){g(b+"prefetch_ajax_jquery_error",1);p();return null}});h(a,e)}var u=!1,v,w;return{streamJSONPrefetchRequest:function(a,b,c,e){if(d.fetch&&d.TextDecoderStream)return x(a,b,c,e);t(a,b,c,e)},fireAndForgetPrefetchRequest:function(a,b){t(a,b,l,l)},getJavaCheckoutPreinitiateIdentifier:function(){return"javaCheckoutPreInitiate:"},executionIdSuccessHandler:function(a,b){a&&a.executionHandle&&a.executionHandle.executionId&&f("preInitiateExecutionId",a.executionHandle.executionId)},
javaCheckoutPreintiateSuccessHandler:function(a,b){b===v&&a&&a.executionHandle&&a.executionHandle.executionId&&(f("preInitiateExecutionId",a.executionHandle.executionId),a.executionHandle.purchaseId&&f("preInitiatePurchaseId",a.executionHandle.purchaseId),f("isJavaPreinitiate",1))},clearInvalidationTimer:r,setInvalidationTimeout:function(){r();w=setTimeout(q,3E5)},isAjaxCallBlocking:function(){return u},setAjaxBlockingFlag:function(a){u=a},getBuyBoxForm:n,clearValueInBuyBox:m,clearJavaPreinitValuesInBuyBox:q,
insertValueInBuyBox:f,getBuyBoxParameters:function(a){if(!n())return[];for(var b=c.$("#sc-buy-box input").serializeArray(),d={},e=0;e<b.length;e++)-1!==a.indexOf(b[e].name)&&(d[b[e].name]=b[e].value);return d}}})});