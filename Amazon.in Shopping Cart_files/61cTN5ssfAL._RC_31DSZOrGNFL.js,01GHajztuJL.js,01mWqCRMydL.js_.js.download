(function(f){var p=window.AmazonUIPageJS||window.P,z=p._namespace||p.attributeErrors,d=z?z("TurboCheckoutBaseAssets",""):p;d.guardFatal?d.guardFatal(f)(d,window):d.execute(function(){f(d,window)})})(function(f,p,z){"use strict";f.register("turbo-function-adapter",function(){return{adapt:function(d){return function(){if("function"!==typeof d)throw"Parameter 'property' is invalid. Expected a function but got "+typeof d;return d.apply(d,arguments)}}}});"use strict";f.when("turbo-configuration","turbo-function-adapter").execute("turbo-signin-adapter-factory",
function(d,a){f.when(d.get(d.KEYS.SHOW_SIGN_IN_INTERFACE)).register("turbo-signin-adapter",function(c){return{show:a.adapt(c.show)}})});"use strict";f.when("turbo-configuration","turbo-function-adapter").execute("turbo-view-adapter-factory",function(d,a){f.when(d.get(d.KEYS.VIEW_ADAPTER)).register("turbo-view-adapter",function(c){return{registerCallbacks:a.adapt(c.registerCallbacks),close:a.adapt(c.close),show:a.adapt(c.show),removeContent:a.adapt(c.removeContent),setContent:a.adapt(c.setContent),
closeImmediatelyThenExecute:a.adapt(c.closeImmediatelyThenExecute),closeAndNavigate:a.adapt(c.closeAndNavigate),closeToFullscreen:a.adapt(c.closeToFullscreen),updateBounds:a.adapt(c.updateBounds),getHeight:a.adapt(c.getHeight),updateMinHeight:a.adapt(c.updateMinHeight),updateScrollHeight:a.adapt(c.updateScrollHeight)}})});"use strict";f.when("turbo-checkout-page-ready").execute(function(){f.declare("turbo-eligibility-override",!1)});"use strict";f.when("A","turbo-checkout-csm","turbo-configuration",
"turbo-checkout-page-ready").register("turbo-checkout-address-id",function(d,a,c){function b(c){for(var b=0;b<c.length;b++){var d=e(c[b]);if(0<d.length)return a.logCount("turboCheckoutAddressSelectorIndex"+b),d}a.logCount("turboCheckoutAddressSelectorMissing");return e()}var e=d.$;return{getAddressId:function(){return b(c.get(c.KEYS.ADDRESS_INPUT_SELECTORS)).val()||""},set:function(a){b(c.get(c.KEYS.ADDRESS_INPUT_SELECTORS)).val()!==a&&b(c.get(c.KEYS.ADDRESS_INPUT_SELECTORS)).val(a).trigger("change",
[a])}}});"use strict";f.when("A","turbo-checkout-utils","turbo-callback-list","turbo-configuration","turbo-checkout-load-events","turbo-checkout-page-ready").register("turbo-checkbox-exclusion-listener",function(d,a,c,b,e){function g(a){var b=r;r=!1;for(var c=0;c<m.length;c++){var d=n(m[c]).find("input[type\x3dcheckbox]");a(d)}b!==r&&(k("Exclusion checkbox state changed"),q.callAll("exclusionCheckbox"))}function h(a){var c;if(!(c=r)){c=!1;for(var b=0;b<a.length&&!c;b++){var d=n(a[b]);(c=d.prop("checked"))&&
k("Exclusion checkbox is checked",d)}}r=c}function k(c,b){a.logDebug("turbo-checkbox-exclusion-listener",c,b)}function l(){g(h)}var m=b.get(b.KEYS.CHECKBOX_EXCLUSION_ROOT_NODES),n=d.$,q=c.create(),r=!1;e.bind(function(){g(function(a){k("Listening for change events on:",a);a.unbind("change",l).bind("change",l);h(a)})});return{onStateChange:function(a){q.push(a)},isAnyCheckboxChecked:function(){return r}}});"use strict";f.when("A","turbo-callback-list","turbo-checkout-load-events","turbo-checkout-page-ready").register("turbo-checkout-custom-price-input",
function(d,a,c){function b(){var a=e();k!==a&&(k=a,h.callAll())}function e(){return g("#gcPriceOverride").val()||""}var g=d.$,h=a.create(),k;c.bind(function(){k=e();g("#gcPriceOverride").unbind("change",b).bind("change",b)});return{getCustomPrice:e,onChange:function(a){h.push(a)}}});"use strict";f.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-configuration","turbo-callback-list","turbo-checkout-load-events","turbo-checkout-page-ready").register("turbo-checkout-quantity-input",function(d,
a,c,b,e,g){function h(a){var b=a?a.value?parseInt(a.value,10):a.target&&a.target.value?parseInt(a.target.value,10):void 0:void 0;r===b?c.logDebug("turbo-checkout-quantity-input","Quantity change event does NOT have new quantity. Suppressing callbacks",void 0):(r=b,c.logDebug("turbo-checkout-quantity-input","Quantity change event",a),m.callAll())}function k(c){c=c.val();(c=parseInt(c,10))||a.logCount("turboCheckoutNoQuantityFromPage");return c}var l=d.$,m=e.create(),n=b.get(b.KEYS.QUANTITY_SELECT_SELECTOR),
q="Multiple quantity nodes present on the page. This may lead to an incorrect quantity being used in Turbo! Selector \x3d "+n,r;g.bind(function(){var b=l(n);r=k(b);b.unbind("change",h).bind("change",h);1<b.length&&(c.logError(q,"turbo-checkout-quantity-input"),c.logDebug("turbo-checkout-quantity-input",q,b));a.logCount("turboCheckoutQuantityNodes",b.length)});return{getQuantity:function(){return k(l(n))},setQuantity:function(a){var c=l(n),b=k(c);a=parseInt(a,10);b!==a&&c.val(a).change()},onChange:function(a){m.push(a)}}});
"use strict";f.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-callback-list","turbo-configuration","turbo-checkout-quantity-input","turbo-checkout-load-events","turbo-checkout-page-ready").register("turbo-checkout-warranty-input",function(d,a,c,b,e,g,h){var k=d.$,l=b.create(),m=e.get(e.KEYS.WARRANTY_CHECKBOX_INPUT_SELECTOR),n=e.get(e.KEYS.WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR),q=e.get(e.KEYS.WARRANTY_ASIN_INPUT_NAME),r=e.get(e.KEYS.WARRANTY_OFFER_INPUT_SELECTOR);h.bind(function(){k(m).unbind("click",
l.callAll).bind("click",l.callAll)});return{select:function(a){a&&k(n+" input[name^\x3d"+q+"][value\x3d"+a+"]").parents(n).find(m).click()},onChange:function(a){l.push(a)},getLineItem:function(b){if(k(m+":checked").length){var d=k(m+":checked").first().parents(n).find("input[name^\x3d"+q+"]").val()||"",e=k(r).val()||"";b=parseInt(b,10)||g.getQuantity()||1;if(d&&e)return{asin:d,offerListingId:e,quantity:b,isDiscoveredAsin:!0};a.logCount("turboCheckoutIncompleteWarrantyInputs");c.logError("Incomplete input data for the selected warranty checkbox - asin:"+
d+", offerId:"+e+", quantity:"+b)}else c.logDebug("turbo-checkout-warranty-input","No warranty checkbox is selected",void 0)}}});"use strict";f.when("A","turbo-checkout-csm","turbo-callback-list","turbo-configuration","turbo-checkout-load-events","turbo-checkout-page-ready").register("turbo-checkout-vas-input",function(d,a,c,b,e){function g(){return m(k).prop("checked")||!1}function h(){var a=q;q=g();a!==q&&n.callAll(q)}var k=b.get(b.KEYS.VAS_CHECKBOX_SELCTOR),l=b.get(b.KEYS.VAS_CHANGE_EVENTS),m=
d.$,n=c.create(),q;e.bind(function(){q=g();l.forEach(function(a){d.off(a,h);d.on(a,h)})});return{isSelected:g,onChange:function(a){n.push(a)}}});"use strict";f.when("A","turbo-checkout-utils","turbo-callback-list","turbo-checkout-load-events","turbo-checkout-csm","turbo-checkout-aui-page-state-parser","turbo-configuration","turbo-checkout-page-ready").register("turbo-checkout-accessories-input",function(d,a,c,b,e,g,h){function k(){var a=w;w=y();w!==a&&u.callAll()}function l(){if(f===z&&v(t).length){var a=
g.parse("simpleBundleParameterMap",".simpleBundleFeatureContainer");0===a.length?(e.logCount("Turbo:Accessories:No:State"),f={}):m(a)}}function m(a){f={};a[0].items.forEach(function(a){f[a.asin]={asin:a.asin,offerListingId:a.offerListingId,isDiscoveredAsin:!0}})}function n(){return v(t).find("input[type\x3dcheckbox]")}function q(){n().unbind("change",k).bind("change",k)}function r(){return v(t).length?1>=w:0===w}function y(){var b=0;n().each(function(){v(this).prop("checked")&&b++});a.logDebug("turbo-checkout-accessories-input",
"Accessories selected "+b);return b}var v=d.$,u=c.create(),w=0,f,t=h.get(h.KEYS.ENABLED_ACCESSORIES_SELECTOR);l();q();b.bind(function(){l();q();y()});return{isEligible:r,registerCallback:function(a){u.push(a)},getLineItem:function(){if(r()){var a=n().filter(":checked").val();a=f?f[a]:void 0;return a||z}return z},select:function(a){a&&v(t+" input[type\x3dcheckbox][value\x3d"+a+"]").click()}}});"use strict";f.when("A","turbo-checkout-csm","turbo-configuration","turbo-checkout-page-ready").register("turbo-checkout-session-id-input",
function(d,a,c){var b=d.$;return{getSessionId:function(){var d=b(c.get(c.KEYS.SESSION_ID_SELECTOR));d&&0<d.length||(a.logCount("turboCheckoutSessionIdSelectorMissing"),d=b());return d.val()||""}}});"use strict";f.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-configuration","turbo-checkout-aui-page-state-parser","turbo-checkout-page-ready").register("java-checkout-url-page-state",function(d,a,c,b,e){function g(a,b){this.javaCheckoutUrl=a;this.javaCheckoutQueryParams=b}function h(a,b){c.logDebug("java-checkout-url-page-state",
a,b)}var k=b.get(b.KEYS.JAVA_CHECKOUT_URL_PAGE_STATE_KEY),l=b.get(b.KEYS.JAVA_CHECKOUT_URL_PAGE_STATE_PARSING_ROOT_NODE_SELECTOR),m=new g("",{});return{get:function(b,c){b=b||k;c=c||l;c=e.parse(b,c);a.logCount("javaCheckoutUrlPageStates",c.length);0===c.length?(h("Java checkout url page state ["+b+"] is NOT present"),b=void 0):b=c[0];b?b=new g(b.javaCheckoutUrl,b.javaCheckoutQueryParams):(a.logCount("javaCheckoutUrlPageStateNotDefined"),b=m);h("Java Checkout Url PageState",b);return b}}});"use strict";
f.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-form","turbo-checkout-ref-tagger","turbo-checkout-page-state","turbo-checkout-product-state","turbo-checkout-page-ready").register("turbo-checkout-joined-state",function(d,a,c,b,e,g,h){function k(a,b,c){b&&(c&&(b.quantity=c),a.push(b))}function l(c,g){function l(){var b=c.turboWeblab;b||a.logCount("turboCheckoutWeblabNameNotDefinedInState");return b}function k(){return c.turboWeblabTreatment}this.pageState=c;this.productStates=
g;this.getLineItems=function(){return h.lineItemInputs};this.getActiveId=function(){return h.id};this.getHeaderText=function(){return h?h.turboHeaderText||c.turboHeaderText:c.turboHeaderText};this.getLoadingText=function(){return c.turboLoadingText};this.getAddressId=function(){return c.addressId};this.getRequestId=function(){return c.requestId};this.getSessionId=function(){return c.sessionId};this.getAdditionalWeblabs=function(){return c.additionalWeblabs};this.getInitiateSelector=function(){return c.initiateSelector};
this.getWeblab=l;this.getWeblabTreatment=k;this.isTurboLaunched=function(){return!l()&&"C"!==k()};this.isProductStateEligible=function(){return g.isTurboEligible};this.getRefTag=function(){if(!h)throw"Turbo checkout product state is NOT resolved. Cannot generate ref tag";var a=d.$("#"+h.id);a=b.getRefTag(a);return e.generateJoinedValue(a)};this.getCSRFToken=function(){return c.csrfToken};this.getClientId=function(){return h&&h.checkoutClientId?h.checkoutClientId:"retailwebsite"};this.resolve=function(a){if(a){h=
g.states[a];if(!h)throw a="Resolved turbo checkout product state is undefined. Id \x3d "+a,m(a,g),a;m("Resolved new product state",h);d.trigger("turbo:checkout:state:product:resolved")}};this.getHoldbackSecondaryPanelsWeblab=function(){return c.holdbackSecondaryPanelsWeblab};var h=1!==g.states.length?z:g.states[0]}function m(a,b){c.logDebug("turbo-checkout-joined-state",a,b)}return{createTurboState:function(b,c,d,e,m,u){if(e&&d)throw"Custom item price is NOT supported with warranty";var r=g.get();
c&&(r.addressId=c);c=h.get();if(b||e||d||u)b=parseInt(b,10),c.states.forEach(function(c){c.lineItemInputs.forEach(function(c){b&&(c.quantity=b);e?(c.customItemPrice=e,a.logCount("turboCheckoutItemPriceOverrided")):c.customItemPrice&&a.logCount("turboCheckoutItemPriceSelectorFallBackToTurboState")});k(c.lineItemInputs,u,b);k(c.lineItemInputs,d,b)});r=new l(r,c);r.resolve(m);return r}}});"use strict";f.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-configuration","turbo-checkout-aui-page-state-parser",
"turbo-constants","turbo-checkout-page-ready").register("turbo-checkout-page-state",function(d,a,c,b,e,g){function h(a,b,c,d,e,h,l,k,n,m,q,f,B){this.version=a;this.turboWeblab=b;this.turboWeblabTreatment=c;this.initiateSelector=d;this.turboLoadingText=e;this.turboHeaderText=h;this.addressId=l;this.requestId=k;this.sessionId=n;this.csrfToken=m;this.turboAssetsMode=q;this.isJavaPipelineEligible="0"!==this.version&&this.turboAssetsMode!==g.ASSET_MODE_TURBO_ONLY;this.additionalWeblabs=f;this.holdbackSecondaryPanelsWeblab=
B}function k(a,b){c.logDebug("turbo-checkout-page-state",a,b)}var l=b.get(b.KEYS.TURBO_PAGE_STATE_KEY),m=b.get(b.KEYS.PAGE_STATE_PARSING_ROOT_NODE_SELECTOR),n=b.get(b.KEYS.LEGACY_SESSION_ID_IDENTIFIER),q=new h("0","","C","#buy-now-button","","","","","","",g.ASSET_MODE_TURBO_ONLY,"","");return{get:function(b,d){b:{b=b||l;d=d||m;d=e.parse(b,d);a.logCount("turboCheckoutPageStates",d.length);if(1<d.length)c.logError("Multiple turbo checkout page states found! Turbo will NOT show","turbo-checkout-page-state",
void 0),k("PageStates",d);else if(0===d.length)k("Turbo checkout page state ["+b+"] is NOT present");else{b=d[0];break b}b=void 0}if(b)if(b.version)b=new h(b.version,b.turboWeblab||"",b.turboWeblabTreatment||"C",b.initiateSelector||".buy-now-button",b.turboLoadingText||"",b.turboHeaderText||"",b.addressId||"",b.requestId||"",b.sessionId||"",b.csrfToken||"",b.turboAssetsMode||g.ASSET_MODE_TURBO_ONLY,b.additionalWeblabs||"{}",b.holdbackSecondaryPanelsWeblab||"{}");else{d=b.inputs||{};var v=b.strings||
{};b=new h("1",b.turboWeblab||"",b.turboWeblabTreatment||"C",(b.configurations||{}).initiateSelector||"#buy-now-button",v.TURBO_LOADING_TEXT||"",v.TURBO_CHECKOUT_HEADER||"",d.addressId||"",d.requestId||"",d.sessionId||d[n]||"",b.csrfToken||"",b.turboAssetsMode||g.ASSET_MODE_TURBO_ONLY,b.additionalWeblabs||"{}",b.holdbackSecondaryPanelsWeblab||"{}")}else a.logCount("turboCheckoutStateNotDefined"),b=q;k("Turbo Checkout PageState",b);return b}}});"use strict";f.when("A","turbo-checkout-csm","turbo-checkout-utils",
"turbo-configuration","turbo-checkout-aui-page-state-parser","turbo-checkout-page-ready").register("turbo-checkout-product-state",function(d,a,c,b,e){function g(a,b){this.isTurboEligible=a;this.states=b}function h(a,b,c,d,e){this.id=a;this.isTurboEligible=b;this.lineItemInputs=c;this.turboHeaderText=d||"";this.checkoutClientId=e}function k(a,b,c,d,e,g,h,l,k,n){this.asin=b||"";this.offerListingId=c||"";this.quantity=parseInt(d,10)||1;this.isTurboEligible=!!this.asin&&!!this.offerListingId&&a;this.productTitle=
e||"";this.incentivizedCart=g||"";this.customItemPrice=h||"";this.addToCartTimeAsUnixEpochMilliseconds=l||"";this.addToCartSessionId=k||"";this.isDiscoveredAsin=!!n}function l(a,b){c.logDebug("turbo-checkout-product-state",a,b)}function m(a){if(!a.lineItemInputs||!a.lineItemInputs.length||!a.id)return l('Versioned product state is invalid. Expected non empty "id" and "lineItemInputs". Turbo may NOT show',a),r;var b=!0,c=d.map(a.lineItemInputs,function(a){a=new k(a.isTurboEligible,a.asin,a.offerListingId,
a.quantity,a.productTitle,a.incentivizedCart,a.customItemPrice,a.addToCartTimeAsUnixEpochMilliseconds,a.addToCartSessionId,a.isDiscoveredAsin);b=b&&a.isTurboEligible;return a});return new h(a.id,b,c,a.turboHeaderText,a.checkoutClientId)}var n=b.get(b.KEYS.TURBO_PRODUCT_STATE_KEY),q=b.get(b.KEYS.PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR),r=new h("buy-now-button",!1,[],"","retailwebsite"),y=new g(!1,[r]);return{get:function(b,d){b=b||n;d=d||q;d=e.parse(b,d);a.logCount("turboCheckoutProductStates",d.length);
1<d.length&&"turbo-checkout-page-state"===b?(c.logError("turbo-checkout-page-state only supports the single item use case! Turbo will NOT show","turbo-checkout-product-state",void 0),b=[]):b=d;if((d=b)&&d.length){var v=!1;b=[];for(var u=0;u<d.length;u++){var t=d[u];if(t)if(t.version)var f=m(t);else t.inputs&&t.eligibility?(f=t.strings||{},t=new k(t.eligibility.isEligible,t.inputs.a,t.inputs.oid,t.inputs.quantity,f.TURBO_CHECKOUT_HEADER,t.inputs.incentivizedCart,t.inputs.customItemPrice),f=new h("buy-now-button",
t.isTurboEligible,[t],f.TURBO_CHECKOUT_HEADER,"retailwebsite")):(l('Legacy product state is missing "inputs" or "eligibility". Turbo will NOT show',t),f=r);else l("Product state parsed DOM object is invalid. Turbo may NOT show",t),f=r;v=v||f.isTurboEligible||!1;t=f.id;if(b[t])throw d="Duplicate product state found. id \x3d "+t,l(d,b),d;b.push(f);b[f.id]=f}b=new g(v,b)}else l("Parsed states are invalid. Turbo will NOT show",d),b=y;l("Turbo Checkout Product State(s)",b);return b}}});"use strict";f.when("A",
"turbo-configuration","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-auto-open","turbo-checkout-address-id","turbo-checkout-quantity-input","turbo-checkout-warranty-input","turbo-checkout-custom-price-input","turbo-callback-list","turbo-checkout-joined-state","turbo-checkout-accessories-input","turbo-checkout-session-id-input","turbo-checkout-page-ready").register("turbo-checkout-state-handler",function(d,a,c,b,e,g,h,k,l,m,n,q,r){function f(a,b,c,d,e,m){a=a||h.getQuantity();b=b||g.getAddressId();
c=c||k.getLineItem(a);d=d||l.getCustomPrice();m=m||q.getLineItem();return n.createTurboState(a,b,c,d,e,m)}function v(a,c){b.logDebug("turbo-checkout-state-handler",a,c)}function u(a,c){b.logWarning("turbo-checkout-state-handler",a,c)}function w(a,b,c,d,e){x=f(a,b,c,z,d,e)}function p(){d.trigger("turbo:checkout:product:onChange");D.callAll()}function t(){var a=f();b.isDeepEquals(x,a)||(x=a,v("New Turbo State",x),p())}var A=d.$,F=a.get(a.KEYS.AJAX_PAGE_UPDATE_EVENT),D=m.create(),C=!1;var x=f();return{isProductTurboEligible:function(){return!C&&
x.isProductStateEligible()||a.get(a.KEYS.OVERRIDE_ELIGIBILITY)},getLineItems:function(){return x.getLineItems()},getAddressId:function(){return x.getAddressId()},getWeblabAllocation:function(){return x.getWeblabTreatment()},registerCallback:function(a){D.push(a)},startMonitoringPage:function(){e.updateInputsAndThen(w);h.onChange(t);k.onChange(t);l.onChange(t);q.registerCallback(t);d.off(F,t);d.on(F,t);p()},getRequestId:function(){return x.getRequestId()},getSessionId:function(){return x.getSessionId()},
getExperimentName:function(){return x.getWeblab()},getAdditionalWeblabAndTreatmentMap:function(){try{return JSON.parse(x.getAdditionalWeblabs())}catch(B){c.logCount("turboCheckoutParseAdditionalWeblabsException"),u("JSON::parse exception. Exception \x3d "+B)}},getStrings:function(){return{TURBO_LOADING_TEXT:x.getLoadingText(),TURBO_CHECKOUT_HEADER:x.getHeaderText()}},getInitiateSelector:function(){return x.getInitiateSelector()},isTurboLaunched:function(){return x.isTurboLaunched()},isPhysicalGiftCardExperimentEligible:function(){var a=
0!==A("#giftcardcustomtwister_feature_div").length;a&&(v("Physical Gift Card use case"),c.logCount("turboCheckoutGiftCardUseCase"));return a},setTurboStateNotEligible:function(){C=!0},resolveProductState:function(a){x.resolve(a)},getActiveId:function(){return x.getActiveId()},getRefTag:function(){return x.getRefTag()},getCSRFToken:function(){var a;(a=x.getCSRFToken())||(a=(a=x.getSessionId())&&0<a.length?a:r.getSessionId());a=a||"";if(!a||0>=a.length)u("CSRF Token is empty. This will result in denied requests."),
c.logCount("turboCheckoutNoValidCSRFToken");return a},getClientId:function(){return x.getClientId()},getHoldbackSecondaryPanelsWeblab:function(){try{return JSON.parse(x.getHoldbackSecondaryPanelsWeblab())}catch(B){c.logCount("turboCheckoutParseHoldbackSecondaryPanelsWeblabException"),u("JSON::parse exception. Exception \x3d "+B)}}}});"use strict";f.when("A","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-aui-page-state-parser",function(d,a){var c=d.$;return{parse:function(b,
d){b="script[data-a-state*\x3d'"+b+"'], #"+b;d=d?c(d).find(b):c(b);b=[];for(var e=0;e<d.length;e++){a:{try{var h=c(d[e]).text();var k=JSON.parse(h);break a}catch(l){a.logError("JSON::parse exception. Exception \x3d "+l,"turbo-checkout-aui-page-state-parser",void 0)}k=void 0}k&&b.push(k)}return b}}});"use strict";f.when("A","turbo-checkout-page-state","turbo-checkout-csm","turbo-checkout-state-handler","tango-checkout-urls","turbo-checkout-page-ready").register("tango-checkout-eligibility",function(d,
a,c,b,e){function g(){var a={},c=b.getAddressId();c&&(a.addressID=c);return a}function h(a){m();q=null;a&&a.isTangoEligible?(c.logCount("tangoCheckoutCustomerEligible"),r&&r()):(l(""),c.logCount("tangoCheckoutCustomerNotEligible"),y&&y())}function k(){m();q=null;l("");c.logCount("tangoCheckoutCustomerEligibilityCallFailed")}function l(a){f.when("ready").execute(function(){d.state("checkout-url-migration-page-state",{checkoutUrl:a})})}function m(){var a=(new Date).getTime()-n;c.logCount("tangoCheckoutCustomerEligibilityTime",
a)}var n,q,r,y;return{setEligibleCallback:function(a){r=a},setIneligibleCallback:function(a){y=a},isEligibleFromPageState:function(){return a.get().isJavaPipelineEligible},checkEligibility:function(){n=(new Date).getTime();q&&(q.abort(),q=null);var a=e.buildEligibilityPathWithParams();q=d.$.ajax(a,{type:"POST",data:g(),success:h,error:k})},setTangoPageStateUrl:l}});"use strict";f.when("A","turbo-configuration","turbo-shopping-portal-switch","java-checkout-url-page-state","turbo-checkout-page-ready").register("tango-checkout-urls",
function(d,a,c,b){function e(a,b){var c=[],d;for(d in a)if(a.hasOwnProperty(d)){var e=a[d];if(b){var g=d;var h=document.createElement("input");h.type="hidden";h.className="checkout-url-migration-request-param";h.name=g;h.value=e;g=h}else g=d+"\x3d"+e;c.push(g)}return c}function g(a){var b=d.$("#sc-buy-box form");if(0!==b.length){var c=document.createDocumentFragment();a.forEach(function(a){c.appendChild(a)});b.append(c)}}var h="unknown";return{buildEligibilityPathWithParams:function(){var b={isAsync:"1",
pipelineType:"Chewbacca"};b.referrer=a.get(a.KEYS.HOST_PAGE_TYPE_IDENTIFIER);b.ref_="chk_"+h+"_eligibility";var d=e(b,!1);b=c.isShoppingPortalEnabled()?"/checkout/turbo/tango-eligibility":"/checkout/tango-eligibility";d=d.join("\x26");return b+"?"+d},buildProceedToCheckoutPathWithParams:function(){var c=b.get(),d={pipelineType:"Chewbacca"};d.referrer=a.get(a.KEYS.HOST_PAGE_TYPE_IDENTIFIER);d.ref_=c.javaCheckoutQueryParams.ref_||"ox_"+h+"_proceed";d=e(d,!0);g(d);return c.javaCheckoutUrl||"/checkout/entry/cart"},
setRefMarkerPageContext:function(a){h=a}}});"use strict";f.when("jQuery","turbo-checkout-auto-open","turbo-checkout-page-ready").register("turbo-checkout-page-load-spinner",function(d,a){function c(){0!==d("#turbo-checkout-auto-load-spinner-container").length&&(d("#turbo-checkout-auto-load-spinner-container").remove(),e.unbind("touchmove touchstart touchend touchcancel click scroll",b))}function b(a){a.preventDefault();a.stopPropagation()}var e=d("body");a.isAutoOpenEligible()&&(e.bind("touchmove touchstart touchend touchcancel click scroll",
b),e.append("\x3cdiv id\x3d'turbo-checkout-auto-load-spinner-container' class\x3d'turbo-checkout-auto-load-spinner-container'\x3e\x3cdiv id\x3d'turbo-checkout-auto-load-circle-container' class\x3d'turbo-checkout-auto-load-circle-container'\x3e\x3cdiv id\x3d'turbo-checkout-auto-load-spinner' class\x3d'a-spinner a-spinner-medium turbo-checkout-auto-load-spinner'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"),setTimeout(c,5E3));return{removePageLoadSpinner:c}});"use strict";f.when("turbo-configuration","turbo-checkout-ref-tagger",
"turbo-checkout-utils","turbo-shopping-portal-switch","turbo-tbyb-shopping-portal-switch","turbo-checkout-state-handler","turbo-checkout-page-ready").register("turbo-checkout-urls",function(d,a,c,b,e,g){function h(){return e.isTBYBShoppingPortalEnabled()&&k()?"/checkout/trybeforeyoubuy/turbo-initiate":b.isShoppingPortalEnabled()?"/checkout/turbo/initiate":"/checkout/turbo-initiate"}function k(){return"primewardrobe"===g.getClientId()}function l(a,b,c){a="\x26pipelineType\x3dturbo\x26clientId\x3d"+
a;var e=d.get(d.KEYS.DEVICE_OVERRIDE);return a+(e?"\x26devicestring-override\x3d"+e:"")+f(b,c)}function m(a){var b=d.get(d.KEYS.HOST_PAGE_TYPE_IDENTIFIER);return"ref_\x3d"+a+"\x26referrer\x3d"+b}function n(a){return c.isNonEmptyString(a)?"\x26weblab\x3d"+a:""}function q(){return d.get(d.KEYS.IS_ADD_TO_CART_ENABLED)?"\x26temporaryAddToCart\x3d1":""}function r(a){if(!a||!a.length)return"";d.get(d.KEYS.IS_ADD_TO_CART_ENABLED)||c.logError('Discovered asins present but add to cart is disabled? This will generate a "clickstream_ignore" hit on the server side and cause the hit to be ignored by clickstream and the attribution lost!',
"turbo-checkout-urls");var b="";a.forEach(function(a,c){b+="\x26discoveredAsins."+c+"\x3d"+a});return b}function f(a,b){var d="";c.isNonEmptyString(a)&&(d+="\x26pageRequestId\x3d"+a);c.isNonEmptyString(b)&&(d+="\x26pageSessionId\x3d"+b);return d}function v(){return e.isTBYBShoppingPortalEnabled()&&k()?"/checkout/trybeforeyoubuy/triggerWeblab":b.isShoppingPortalEnabled()?"/checkout/turbo/triggerWeblab":"/checkout/triggerWeblab"}function u(){return p("auiDebug","auiDebug")+p("ds_user","ds_user")+p("ds_turbo_workspace",
"ds_workspace")+p("stringDebug","stringDebug")}function w(a){a=a?a:[];var b="";a.forEach(function(a,c){b+="\x26asin."+(c+1)+"\x3d"+a.asin});return b}function p(a,b){var d="";a=c.getUrlQueryParam(a);c.isNonEmptyString(a)&&(d="\x26"+b+"\x3d"+a);return d}return{buildInitiatePathWith:function(a,b,c,d,e,g){return h()+"?"+m(a)+l(c,d,e)+n(b)+q()+u()+w(g)},buildEligibilityPathWith:function(a,b,c,d,e){return h()+"?"+m(a)+l(c,d,e)+n(b)+"\x26checkEligibilityOnly\x3dtrue"+q()+u()},buildConfirmPathWith:function(a,
b,c,d,e,g){return h()+"/confirm?"+m(a)+l(c,d,e)+n(b)+q()+r(g)},buildLogPageHitPathWith:function(c,d,g){return(e.isTBYBShoppingPortalEnabled()&&k()?"/checkout/trybeforeyoubuy/log-page-hit":b.isShoppingPortalEnabled()?"/checkout/turbo/log-page-hit":"/checkout/log-page-hit")+"?"+a.generateRefTag(c,a.ACTIONS.CLOSE,d)+l(g)},buildTriggerWeblabPathWith:function(a,b,c,d,e){return v()+"?"+m(a)+n(b)+"\x26weblabAllocation\x3d"+c+f(d,e)},buildTriggerWeblabPathWithoutWeblab:function(a,b,c){return v()+"?"+m(a)+
f(b,c)}}});"use strict";f.when("turbo-checkout-page-ready").register("turbo-callback-list",function(){function d(){var a=[];this.callAll=function(){for(var c=0;c<a.length;c++){var b=a[c];b.apply(b,arguments)}};this.push=function(c){if("function"!==typeof c)throw"Invalid callback. Expected typeof 'callback' to be 'function'. typeof \x3d "+typeof c;-1===a.indexOf(c)&&a.push(c)};this.remove=function(c){c=a.indexOf(c);-1!==c&&a.splice(c,1)}}return{create:function(){return new d}}});"use strict";f.when("turbo-callback-list",
"turbo-checkout-page-ready").register("turbo-filtered-callback-list",function(d){function a(a){var b=d.create();this.callAll=b.callAll;this.remove=b.remove;this.push=function(c){(c=c[a])&&"function"===typeof c&&b.push(c)}}return{create:function(c){if(!c||"string"!==typeof c)throw"Invalid filter parameter. Expected 'filter' to be a non empty string. typeof \x3d "+typeof c+" value \x3d "+c;return new a(c)}}});"use strict";f.when("A","turbo-configuration","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-form",
function(d,a,c){function b(b){var c=a.get(a.KEYS.FORM_SELECTOR_OVERRIDE);if(c&&0<e(c).length)return e(c);c=a.get(a.KEYS.FORM_TYPE);if("link"===c)return b.find("a");if("form"===c)return b.closest("form");throw"Unsupported FORM_TYPE is configured. value \x3d "+c;}var e=d.$,g=/[\/?&]ref_?=([^?&]+)/;return{getForms:b,getRefTag:function(a){if(1!==a.length)return c.logError("Expected getRefTag input to have a single element. Cannot resolve refTag as this is a data quality risk","turbo-checkout-form"),c.logDebug("turbo-checkout-form",
"Expected getRefTag input to have a single element. Cannot resolve refTag as this is a data quality risk",a),"";a=b(a);a=((a.attr("action")||a.attr("href")||"")+"\x26"+a.serialize()).match(g)||{};return 2===a.length?a[1]:""}}});"use strict";f.when("A","turbo-checkout-page-ready").register("turbo-checkout-ajax-wrapper",function(d){return{load:function(a,c){c.hasOwnProperty("timeout")||(c.timeout=2E4);return d.ajax(a,c)},loadWithJQXHR:function(a,c){c.hasOwnProperty("timeout")||(c.timeout=2E4);return d.$.ajax(a,
c)},createXHRRequest:function(){var a=new XMLHttpRequest;a.timeout=2E4;return a}}});"use strict";f.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-session-storage","turbo-checkout-quantity-input","turbo-checkout-address-id","turbo-checkout-warranty-input","turbo-checkout-accessories-input","turbo-checkout-page-ready").register("turbo-checkout-auto-open",function(d,a,c,b,e,g,h,k){function l(a,b){c.logDebug("turbo-checkout-auto-open",a,b)}function m(){return n()&&0!==v}function n(){var d;
if(d="1"===w.trb_open||"1"===c.getUrlQueryParam("trb_open"))(d=b.isPresent("hasTurboAutoOpened"))&&a.logCount("turboCheckoutAutoOpenLoopPrevented"),d=!d;return d}function q(){return 1===v&&n()}function r(){q()&&(m()&&(v=2,b.set("hasTurboAutoOpened","1")),K(w.trb_bid),d.trigger("turbo:checkout:auto:open"))}var f=d.$,v=0,u="trb_open trb_addr trb_qty trb_warrAsin trb_auth trb_sid trb_bid trb_accessoryAsin trb_accessoryOffer".split(" "),w={},K=function(){};return{setup:function(a,b){if(n()){v=1;var e=
p.location.href;f.each(u,function(a,b){a=c.getUrlQueryParam(b);w[b]=a;e=c.removeQueryParam(b,a,e)});l("Parameters:",w);c.replaceHistory(e);"function"===typeof a?K=a:c.logError("Initiate action must be supplied, and it must be a function.");d.on("turbo:checkout:prefetcher:state:dataStale",r);b()}else v=0,l("Disabled")},reset:function(){b.remove("hasTurboAutoOpened")},isAutoOpenEligible:n,isAutoOpenEnabled:m,isAutoOpenReadyToBeOpened:q,updateInputsAndThen:function(a){var b=w.trb_qty,c=w.trb_addr,d=
w.trb_warrAsin,l=w.trb_bid,n=w.trb_accessoryAsin,m=w.trb_accessoryOffer;if(b||c||d||l||n||m){b&&e.setQuantity(b);c&&g.set(c);if(d){h.select(d);var q=h.getLineItem(b)}if(n&&m){k.select(n);var r=k.getLineItem()}a(b,c,q,l,r)}}}});"use strict";f.when("turbo-checkout-page-ready").register("turbo-checkout-utils",function(){function d(){return navigator.userAgent}function a(b,c){if(b===c||"function"===typeof b&&"function"===typeof c)return!0;if(typeof b!==typeof c)return!1;if("object"!==typeof b||null===
b||null===c)return b===c||b!==b&&c!==c;var d=Object.getOwnPropertyNames(b);if(d.length!==Object.getOwnPropertyNames(c).length)return!1;for(var e=0;e<d.length;e++){var k=d[e];if(!b.hasOwnProperty(k)||!c.hasOwnProperty(k)||!a(b[k],c[k]))return!1}return!0}var c={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#039;"};return{logError:function(a,c){f.log(a,"ERROR",c||"turbo-checkout-utils")},logWarning:function(a,c){f.log(a,"WARN",c||"turbo-checkout-utils")},logDebug:function(){},
getUserAgent:d,isAndroid:function(){return!!d().match(/[a|A]ndroid/)},isIPhone:function(){return!!d().match(/iPhone/)},isIPad:function(){return!!d().match(/iPad/)},isInternetExplorer:function(){return!!d().match(/MSIE/)},createFQDN:function(a){/^http/.test(a)||(a=p.location.origin?p.location.origin+a:p.location.protocol+"//"+p.location.hostname+":"+p.location.port+a);return a},getUrlQueryParam:function(a,c){c||(c=p.location.href);a=a.replace(/[\[\]]/g,"\\$\x26");return(a=(new RegExp("[?\x26]"+a+"(\x3d([^\x26#]*)|\x26|#|$)")).exec(c))?
a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":z},removeQueryParam:function(a,c,d){var b=d;a&&c&&d&&(a=a+"\x3d"+c,b=d.replace(new RegExp("\\?"+a+"[\x26]?","g"),"?"),b=b.replace(new RegExp("[\x26]?"+a,"g"),""));return b},replaceHistory:function(a){p.history.pushState&&p.history.replaceState(null,p.title,a)},isNonEmptyString:function(a){return"string"===typeof a&&0<a.length},isDeepEquals:a,escapeHtml:function(a){return a.replace(/[&<>"']/g,function(a){return c[a]})}}});"use strict";f.when("turbo-checkout-utils",
"turbo-checkout-page-ready").register("turbo-checkout-csm",function(d){function a(a,c,d,e){return"function"===typeof p.uet?p.uet.apply(p.uet,arguments):e||b()}function c(a,b,c){return"function"===typeof p.ues?p.ues.apply(p.ues,arguments):c}function b(){return+new Date}function e(d){function e(){k&&g&&l&&h&&!f&&"function"===typeof u&&(u(k,g,l,h),f=!0)}var g,h,l,k,f=!1,u;this.getId=function(){return d};this.markClick=function(){k=a("tc",d)};this.markFirstByte=function(){g=c("t0",d,b())};this.markAboveTheFold=
function(){l=a("af",d);e()};this.markCriticalFeature=function(){h=a("cf",d);e()};this.whenDataSet=function(a){u=a;e()}}function g(a){"undefined"!==typeof p.ue_t0&&p.ue.count(a,Date.now()-p.ue_t0)}var h=0,k=[];return{createScope:function(){return new e("chk_turbo_"+ ++h)},logCount:function(a,b){b=b||1;d.logDebug("Logging counter "+a+" with value "+b);if(p.ue&&p.ue.count){var c=a+"_time";p.ue.count(a,b);g(c);for(var e=0;e<k.length;++e)p.ue.count(a+"."+k[e],b),g(c+"."+k[e])}},addCounterExtraSuffix:function(a){k.push(a)},
timestamp:b}});"use strict";f.when("A","turbo-checkout-csm","turbo-checkout-page-ready").register("turbo-checkout-counter",function(d,a){var c=0,b=0,e=0,g=0,h=0,k=0,l="u";d.on("turbo:checkout:sheet:beforeOpen",function(){a.logCount("turboCheckoutSheetOpen",c);"u"!==l?(++h,a.logCount("turboCheckoutPrefetchUsed",h),"p"===l?a.logCount("turboCheckoutPrefetchUsedInProgress",h):a.logCount("turboCheckoutPrefetchUsedFull",h)):(++k,a.logCount("turboCheckoutPrefetchMissing",k))});d.on("turbo:checkout:sheet:beforeClose",
function(){++b;a.logCount("turboCheckoutSheetClose",b)});d.on("turbo:checkout:prefetcher:state:dataPrefetching",function(){a.logCount("turboCheckoutPrefetchRequested",e);l="p"});d.on("turbo:checkout:prefetcher:state:dataFresh",function(){++g;a.logCount("turboCheckoutPrefetchAvailable",g);l="a"});d.on("turbo:checkout:prefetcher:state:dataStale",function(){l="u"});return{incrementSheetOpenedCounter:function(){c++},incrementPrefetchCounter:function(){e++},getSheetOpenCount:function(){return c},getPrefetchCount:function(){return e}}});
"use strict";f.when("turbo-checkout-page-ready").register("turbo-checkout-cacher",function(){return{createCache:function(d){var a=!1,c;return function(){a||(c=d(),a=!0);return c}}}});"use strict";f.when("A","turbo-configuration","turbo-checkout-utils","turbo-checkout-counter","turbo-checkout-page-ready").register("turbo-checkout-ref-tagger",function(d,a,c,b){function e(a,c,d){a="chk_"+a+"_"+(c+"_"+b.getPrefetchCount()+"-"+b.getSheetOpenCount());return g(d?a+"_"+d:a)}function g(a){if(!("string"===
typeof a&&0<a.length&&64>=a.length&&k.test(a))||l.test(a))throw"Invalid ref tag. This would be filtered and replaced in clickstream. Value \x3d "+a;return a}var h={ELIGIBILITY:"eligibility",BUY_NOW:"buyNow",CLOSE:"close"},k=/(^[A-z]$|^[A-z][A-z0-9_-]*[A-Za-z0-9]$)/,l=/[_-]{2,}/,m=a.get(a.KEYS.HOST_PAGE_TYPE_IDENTIFIER);return{generateRefTag:function(a,b,c){return"ref_\x3d"+e(a,b,c)},generateValue:e,generateJoinedValue:function(a){if(!a)return e(m,h.BUY_NOW,"fallback");try{var d=a+"_"+(h.BUY_NOW+"_"+
b.getPrefetchCount()+"-"+b.getSheetOpenCount());return g(d)}catch(r){return c.logError(r,"turbo-checkout-ref-tagger"),e(m,h.BUY_NOW,"fallback")}},generateEligibilityValue:function(){return e(m,h.ELIGIBILITY)},ACTIONS:h,TAGS:{TOUCH:"touch",TOUCH_X:"touchX",BACK:"back",ROTATION:"rotation",DONE:"done"}}});"use strict";f.when("A","turbo-checkout-page-ready").register("turbo-checkout-prefetch-timer",function(d){function a(){g||(g=!0,d.trigger("turbo:checkout:timer:onTimeout"))}function c(){if(g)return!0;
var a=(new Date).getTime();return e?6E5<=a-e:!1}var b,e,g=!1;return{startTimer:function(){b||(b=p.setTimeout(a,6E5));e||(e=(new Date).getTime())},isTimeout:c,resetTimer:function(){p.clearTimeout(b);g=!1;e=b=null},checkTimeout:function(){c()&&a()}}});"use strict";f.when("A","jQuery","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-state-handler","turbo-checkout-form","turbo-checkout-buy-now-onclick-handler","turbo-configuration","turbo-checkout-page-ready").register("turbo-checkout-buy-now-button",
function(d,a,c,b,e,g,h,k){function l(a,c){b.logDebug("turbo-checkout-buy-now-button",a,c)}function m(b){return b?n(b):a(e.getInitiateSelector())}function n(d){var e=a("#"+d),g=k.get(k.KEYS.BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID);if(!g)return e;var h=a("[id\x3d"+d+"]");if(2>h.length)return e;c.logCount("turboCheckoutBuyNowDuplicateIdPresent");l("Duplicate nodes present for BuyNow button ID: #"+d+". Resolving BuyNow button with CSS: "+g);h=h.filter(g);return 1!==h.length?(c.logCount("turboCheckoutBuyNowUnableToResolveButtonIdWithCss"),
b.logError("Unable to resolve a unique BuyNow button with CSS: "+g+". Defaulting to first button with ID: #"+d,"turbo-checkout-buy-now-button",void 0),e):h}function q(b){l("Buy now button clicked");c.logCount("turboCheckoutBuyNowClicked");h.isConflictingOnClickListenerPresent(a(b.currentTarget))&&(A=!0);b&&b.currentTarget&&b.currentTarget.id||(l("Click event target is INVALID. Expected event target with an id. Turbo will NOT show",b),A=!0);if(A)A=!1,l("Buy now button callbacks supressed");else{e.resolveProductState(b.currentTarget.id);
l("Calling buy now button callbacks...");var d=!1;for(var k=0;k<t.length;k++)d=d||t[k]();d?(l("Supressing default buy now button action"),b.preventDefault(),b.stopPropagation(),b.stopImmediatePropagation(),d=!0):d=void 0;if(d)return!1}g.getForms(a(b.currentTarget)).attr("data-action",f());l("Calling default BuyNow action. User will be sent to Checkout SPC. Turbo will NOT show.");c.logCount("turboCheckoutBuyNowDefault");h.callCachedOnClickListenerIfPresent(b.currentTarget,b);return!0}function f(){return m().attr("name")||
"submit.buy-now"}function y(a){for(var b=t.length-1;0<=b;--b)t[b]===a&&t.splice(b,1)}function v(a){if(!a&&1<m().length)throw"Button id parameter is NOT present. Cannot execute action without a button id on a page with multiple buy now buttons!";}function u(a){a=m(a);w(a);a.click()}function w(b){for(var d=k.get(k.KEYS.CONFLICTING_INITIATE_LISTENERS),e=0;e<d.length;e++){var g=d[e];l("Unbound configured event '"+g+"' from buy now button");c.logCount("turboCheckoutBuyNowButtonConflictingListeners");b.unbind(g);
a(document.body).undelegate(b.selector,g)}}var p=k.get(k.KEYS.BUY_NOW_CLICK_EVENT),t=[],A=!1;d.on("turbo:checkout:clickInitiate",u);c.logCount("turboCheckoutBuyNowButtonBound");return{registerOnClickCallback:function(a){y(a);t.push(a)},deregisterOnClickCallback:y,executeOriginalBuyNowAction:function(a){v(a);A=!0;d.trigger("turbo:checkout:buyNowDisabled");d.trigger("turbo:checkout:clickInitiate",a)},executeTurboBuyNowAction:function(a){v(a);A=!1;u(a)},getSubmitAction:f,bindTurboClickEvent:function(a){a=
a||m();h.removeConflictingOnClickListenerIfPresentAndCacheIt(a);a.unbind(p).bind(p,q)},removeConflictingListeners:w,getBuyNowButtons:m}});"use strict";f.when("A","jQuery","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-buy-now-onclick-handler",function(d,a,c,b){function e(b,c){b.each(function(b,d){a(d).removeProp(c)})}function g(b,c){var d=!1;b.each(function(){var b=a(this),e=b.find("[onclick]"),g=b.prop("onclick"),h=e.prop("onclick");return l(g)&&
l(h)||1<e.length||!l(g||h)||k(b)!==c?(d=!0,!1):!0});return d}function h(a){return a.prop("onclick")||a.find("[onclick]").prop("onclick")}function k(a){return a.attr("onclick")||a.find("[onclick]").attr("onclick")}function l(a){return"function"===typeof a}function m(a,c){b.logDebug("turbo-checkout-buy-now-onclick-handler",a,c)}var n;return{callCachedOnClickListenerIfPresent:function(a,b){l(n)&&(m("BuyNow button onclick listener function called."),c.logCount("turboCheckoutBuyNowButtonOnClickListenerCalled"),
n.call(a,b.originalEvent))},removeConflictingOnClickListenerIfPresentAndCacheIt:function(a){var b=h(a),d=k(a);l(b)&&d&&(g(a,d)?(m("[DOM ERROR] Turbo will NOT show. BuyNow button node has INVALID 'onclick' DOM structure.",a),c.logCount("turboCheckoutBuyNowButtonInvalidOnClickDOM")):(m("BuyNow button node has 'onclick' attribute. Removing its listener and caching it.",a),c.logCount("turboCheckoutBuyNowButtonOnClickListenerRemoveAndCache"),n=b,b=a.find("[onclick]"),e(a,"onclick"),e(b,"onclick")))},isConflictingOnClickListenerPresent:function(a){if(a=
l(h(a)))m("Turbo will NOT show. BuyNow button node has conflicting 'onclick' listener."),c.logCount("turboCheckoutBuyNowButtonConflictingOnClickListener");return a}}});"use strict";f.when("A","turbo-checkout-utils","turbo-checkout-buy-now-button","turbo-checkout-page-ready").register("turbo-checkout-buy-now-integration",function(d,a,c){function b(b,c){a.logDebug(b,"turbo-checkout-buy-now-integration",c)}var e=d.$,g=[];d.on("turbo:checkout:page:reappear",function(){b("Removing additional form inputs from form",
g);for(var a;(a=g.shift())!==z;)a.remove()});return{isBuyNow:function(a){return a instanceof e&&a.attr("data-action")===c.getSubmitAction()},checkoutWith:function(c,d){if(Array.isArray(c)&&d instanceof e){var h=d;for(var k=1;0<h.find('input[name\x3d"asin.'+k+'"]').length||0<h.find('input[name\x3d"offeringID.'+k+'"]').length;)k++;h=k;k=[];for(var n=0;n<c.length;n++){var f=c[n];if(f!==z&&f.asin&&f.offerListingId){var r=h;f=[e("\x3cinput /\x3e",{type:"hidden",name:"asin."+r,value:f.asin}),e("\x3cinput /\x3e",
{type:"hidden",name:"offeringID."+r,value:f.offerListingId}),e("\x3cinput /\x3e",{type:"hidden",name:"quantity."+r,value:f.quantity||1})];Array.prototype.push.apply(k,f);h++}else b('Line item inputs are invalid. Expected "asin" and "offerListingId" keys in object. Customer purchase inputs ignored!',f),a.logError('Line item inputs are invalid. Expected "asin" and "offerListingId" keys in object. Customer purchase inputs ignored!')}n=d.find('input[name\x3d"itemCount"]');1===n.length?n.val(h):d.append(e("\x3cinput /\x3e",
{type:"hidden",name:"itemCount",value:h}));b("Appended additional buy now inputs.",k);d.append.apply(d,k);g=k}else h="Inputs are invalid. Expected array and jQuery object. lineItems \x3d "+c+" $form \x3d "+d,b(h,arguments),a.logError(h)}}});"use strict";f.when("turbo-checkout-page-ready").register("turbo-configuration-keys",function(d){var a={HOST_PAGE_TYPE_IDENTIFIER:"HOST_PAGE_TYPE_IDENTIFIER",FORM_TYPE:"FORM_TYPE",FORM_SELECTOR_OVERRIDE:"FORM_SELECTOR_OVERRIDE",BUY_NOW_BUTTON_SELECTOR:"BUY_NOW_BUTTON_SELECTOR",
BUY_NOW_BUTTON_V2_SELECTOR:"BUY_NOW_BUTTON_V2_SELECTOR",BUY_NOW_CLICK_EVENT:"BUY_NOW_CLICK_EVENT",BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID:"BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID",QUANTITY_SELECT_SELECTOR:"QUANTITY_SELECT_SELECTOR",ADDRESS_INPUT_SELECTORS:"ADDRESS_INPUT_SELECTORS",SESSION_ID_SELECTOR:"SESSION_ID_SELECTOR",LEGACY_SESSION_ID_IDENTIFIER:"LEGACY_SESSION_ID_IDENTIFIER",WARRANTY_CHECKBOX_INPUT_SELECTOR:"WARRANTY_CHECKBOX_INPUT_SELECTOR",WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR:"WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR",
WARRANTY_ASIN_INPUT_NAME:"WARRANTY_ASIN_INPUT_NAME",WARRANTY_OFFER_INPUT_SELECTOR:"WARRANTY_OFFER_INPUT_SELECTOR",AJAX_PAGE_UPDATE_EVENT:"AJAX_PAGE_UPDATE_EVENT",PREFETCH_TREATMENT:"PREFETCH_TREATMENT",NO_PREFETCH_TREATMENT:"NO_PREFETCH_TREATMENT",BUY_NOW_ONLY_TREATMENT:"BUY_NOW_ONLY_TREATMENT",IS_DEVICE_FILTER_REQUIRED:"IS_DEVICE_FILTER_REQUIRED",IS_SIGN_IN_SUPPORTED:"IS_SIGN_IN_SUPPORTED",USES_MASH_WILL_REAPPEAR:"USES_MASH_WILL_REAPPEAR",SHOW_SIGN_IN_INTERFACE:"SHOW_SIGN_IN_INTERFACE",IFRAME_ID:"IFRAME_ID",
EXTEND_ELIGIBLE_STATE:"EXTEND_ELIGIBLE_STATE",VIEW_ADAPTER:"VIEW_ADAPTER",PAGE_STATE_PARSING_ROOT_NODE_SELECTOR:"PAGE_STATE_PARSING_ROOT_NODE_SELECTOR",PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR:"PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR",JAVA_CHECKOUT_URL_PAGE_STATE_PARSING_ROOT_NODE_SELECTOR:"JAVA_CHECKOUT_URL_PAGE_STATE_PARSING_ROOT_NODE_SELECTOR",TURBO_PAGE_STATE_KEY:"TURBO_PAGE_STATE_KEY",TURBO_PRODUCT_STATE_KEY:"TURBO_PRODUCT_STATE_KEY",JAVA_CHECKOUT_URL_PAGE_STATE_KEY:"JAVA_CHECKOUT_URL_PAGE_STATE_KEY",
DEVICE_OVERRIDE:"DEVICE_OVERRIDE",CONFLICTING_INITIATE_LISTENERS:"CONFLICTING_INITIATE_LISTENERS",VAS_CHANGE_EVENTS:"VAS_CHANGE_EVENTS",VAS_CHECKBOX_SELCTOR:"VAS_CHECKBOX_SELCTOR",CHECKBOX_EXCLUSION_ROOT_NODES:"CHECKBOX_EXCLUSION_ROOT_NODES",MASH_ADAPTER:"MASH_ADAPTER",IS_ADD_TO_CART_ENABLED:"IS_ADD_TO_CART_ENABLED",IS_BUYNOW_ENABLED_FOR_SCREENREADER:"IS_BUYNOW_ENABLED_FOR_SCREENREADER",BACKGROUND_SCROLL_TARGET_SELECTOR:"BACKGROUND_SCROLL_TARGET_SELECTOR",NO_PREFETCH_EXPERIMENT_WEBLABS:"NO_PREFETCH_EXPERIMENT_WEBLABS",
ENABLED_ACCESSORIES_SELECTOR:"ENABLED_ACCESSORIES_SELECTOR",OVERRIDE_ELIGIBILITY:"OVERRIDE_ELIGIBILITY",validate:function(c){if("string"!==typeof c||!a[c])throw"The key '"+c+"' is not defined within 'turbo-configuration-keys'.";}};return a});"use strict";f.when("A","turbo-configuration-keys","turbo-device-configuration","turbo-client-configuration","turbo-eligibility-override","turbo-checkout-page-ready").register("turbo-configuration",function(d,a,c,b,e){function g(a,b){var c=h(a);f[a]=c===z?b:c}
function h(a){var d=b[a];a=c[a];if(k(d))return d;if(k(a))return a}function k(a){return"boolean"===typeof a||a}function l(a){if(!k(b[a])&&!k(c[a]))throw"Required configuration override for key '"+a+"' is missing";f[a]=h(a)}var f;return{get:function(b){a.validate(b);f||(f={},l(a.HOST_PAGE_TYPE_IDENTIFIER),l(a.SHOW_SIGN_IN_INTERFACE),l(a.EXTEND_ELIGIBLE_STATE),l(a.VIEW_ADAPTER),g(a.FORM_TYPE,"form"),g(a.FORM_SELECTOR_OVERRIDE,""),g(a.BUY_NOW_BUTTON_SELECTOR,"#buy-now-button"),g(a.BUY_NOW_BUTTON_V2_SELECTOR,
".checkout-buy-now"),g(a.BUY_NOW_CLICK_EVENT,"click.turboCheckout"),g(a.BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID,""),g(a.QUANTITY_SELECT_SELECTOR,'select[name\x3d"quantity"]'),g(a.SESSION_ID_SELECTOR,""),g(a.LEGACY_SESSION_ID_IDENTIFIER,""),g(a.ADDRESS_INPUT_SELECTORS,["#unifiedLocation1ClickAddress","#unifiedLocationAddress"]),g(a.WARRANTY_CHECKBOX_INPUT_SELECTOR,".mbb-checkbox input[name\x3dmbba]"),g(a.WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR,".mbb-checkbox-column"),g(a.WARRANTY_ASIN_INPUT_NAME,
"mbba"),g(a.WARRANTY_OFFER_INPUT_SELECTOR,"#mbb-offering-id"),g(a.AJAX_PAGE_UPDATE_EVENT,"a:pageUpdate"),g(a.PREFETCH_TREATMENT,"PREFETCH_DISABLED"),g(a.NO_PREFETCH_TREATMENT,"T1"),g(a.BUY_NOW_ONLY_TREATMENT,"BUY_NOW_LAUNCHED"),g(a.IS_DEVICE_FILTER_REQUIRED,!1),g(a.IS_SIGN_IN_SUPPORTED,!0),g(a.USES_MASH_WILL_REAPPEAR,!1),g(a.IFRAME_ID,"turbo-checkout-iframe"),g(a.PAGE_STATE_PARSING_ROOT_NODE_SELECTOR,"#turboState"),g(a.PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR,"#turboState"),g(a.JAVA_CHECKOUT_URL_PAGE_STATE_PARSING_ROOT_NODE_SELECTOR,
"#turboState"),g(a.TURBO_PAGE_STATE_KEY,"turbo-checkout-page-state"),g(a.TURBO_PRODUCT_STATE_KEY,"turbo-checkout-page-state"),g(a.JAVA_CHECKOUT_URL_PAGE_STATE_KEY,"java-checkout-url-page-state"),g(a.DEVICE_OVERRIDE,""),g(a.CONFLICTING_INITIATE_LISTENERS,[]),g(a.CHECKBOX_EXCLUSION_ROOT_NODES,"#simpleBundle_feature_div #monthlyPayments_feature_div #bbg_feature_div #addons_feature_div #mobile-accessory-upsell #detailPageGifting_feature_div #twister-plus-feature".split(" ")),g(a.ENABLED_ACCESSORIES_SELECTOR,
".simpleBundleCheckBoxArea"),g(a.MASH_ADAPTER,""),g(a.IS_ADD_TO_CART_ENABLED,!0),g(a.IS_BUYNOW_ENABLED_FOR_SCREENREADER,!0),g(a.BACKGROUND_SCROLL_TARGET_SELECTOR,"#productTitleGroupAnchor"),g(a.VAS_CHANGE_EVENTS,["turbo:checkout:sheet:doClose"]),g(a.VAS_CHECKBOX_SELCTOR,"#vas-checkbox-input"),g(a.VAS_CHANGE_EVENTS,["turbo:checkout:sheet:doClose"]),g(a.VAS_CHECKBOX_SELCTOR,"#vas-checkbox-input"),g(a.NO_PREFETCH_EXPERIMENT_WEBLABS,["RCX_CHECKOUT_TURBO_PRIME_UPSELL_222066"]),g(a.OVERRIDE_ELIGIBILITY,
e));var c=f;return c[b]},KEYS:d.copy(a)}});"use strict";f.when("A","turbo-checkout-utils","turbo-checkout-weblab-allocation","turbo-checkout-state-handler","turbo-checkbox-exclusion-listener","turbo-checkout-content-loader","turbo-checkout-device-filter","turbo-callback-list","turbo-checkout-auto-open","turbo-checkout-vas-input","turbo-checkout-accessories-input","turbo-checkout-page-ready").register("turbo-base-eligible-state",function(d,a,c,b,e,g,h,k,l,f,n){function m(){t=!0}function r(){t=!1}function y(){var a=
new v;h.isDeviceTurboEligible()||a.invalidate("Device is NOT eligible");g.isError()&&!c.isNoPrefetch()&&a.invalidate("Prefetch failed");b.isProductTurboEligible()||a.invalidate("Product is NOT eligible");l.isAutoOpenEnabled()||t||a.invalidate("Cheetah eligibility response is false");c.isControl()&&a.invalidate("Weblab is in CONTROL");c.isBuyNowOnly()&&a.invalidate("Weblab is in buy now only treatment");f.isSelected()&&a.invalidate("Value added service is selected and NOT supported");n.isEligible()||
a.invalidate("Accessory selection was not eligible");e.isAnyCheckboxChecked()&&a.invalidate("Exclusion case checkbox is checked");0!==A("#account-linking").length&&a.invalidate("Account linking checkbox present");w.callAll(a);a.logInvalidState();return a.canShow()}function v(){var b=!0,c=[];this.invalidate=function(a){b=!1;c.push(a)};this.logInvalidState=function(){b||a.logDebug("turbo-base-eligible-state","Cannot show turbo because: "+c)};this.canShow=function(){return b}}function u(a){p.callAll(y(),
a)}var w=k.create(),p=k.create(),t=!1,A=d.$;return{addStateCheck:function(a){w.push(a)},canShow:y,registerStateChangeCallback:function(a){p.push(a)},onStateChange:u,setup:function(){g.registerCallback({onTurboEligible:m,onFinish:m,onTurboIneligible:r});b.registerCallback(u);e.onStateChange(u);f.onChange(u);n.registerCallback(u)}}});"use strict";f.when("A","turbo-callback-list","turbo-checkout-page-ready").register("turbo-checkout-base-view",function(d,a){function c(b){if("string"!==typeof b)throw"Parameter 'iFrameContainerSelector' is not a string.";
this.onBoundsAdjustedCallbacks=a.create();this.IFRAME_CONTAINER_SELECTOR=b}var b=d.$;c.prototype.updateBounds=function(a,b){if("number"!==typeof a)throw'Parameter "iFrameContainerHeightInPixels" is not a number. Cannot validate bounds.';var c=this.$getIFrameContainer().height(),d=a-c,e=c+d;0!==d&&(this.$getIFrameContainer().height(e),this.updateScrollHeight(a,b),a=parseInt(this.$getIFrameContainer().css("min-height"),10),e=e>a?e:a,c!==e&&this.onBoundsAdjustedCallbacks.callAll(e))};c.prototype.updateScrollHeight=
function(a,b){b&&a!==b?(this.$getIFrame().height(b),this.$getIFrameContainer().css("overflow-y","scroll"),this.$getIFrameContainer().css("-webkit-overflow-scrolling","touch")):(this.$getIFrame().height("100%"),this.$getIFrameContainer().css("overflow-y",""),this.$getIFrameContainer().css("-webkit-overflow-scrolling",""))};c.prototype.getHeight=function(){return this.$getIFrameContainer().height()};c.prototype.$getIFrameContainer=function(){return b(this.IFRAME_CONTAINER_SELECTOR)};c.prototype.$getIFrame=
function(){return b(this.IFRAME_CONTAINER_SELECTOR+" iframe")};c.prototype.pushBoundsAdjustedCallback=function(a){this.onBoundsAdjustedCallbacks.push(a)};return{extend:function(){function a(){c.apply(this,arguments)}a.prototype=Object.create(c.prototype);return a.prototype.constructor=a}}});"use strict";f.when("turbo-configuration","turbo-checkout-page-ready").execute("turbo-eligible-state-check",function(d){d.get(d.KEYS.EXTEND_ELIGIBLE_STATE)||f.when("turbo-base-eligible-state").register("turbo-checkout-eligible-state",
function(a){return{canShow:a.canShow,registerStateChangeCallback:a.registerStateChangeCallback,setup:a.setup}})});"use strict";f.when("A","turbo-checkout-state-handler","turbo-configuration","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-weblab-allocation",function(d,a,c){function b(){return a.getWeblabAllocation()}function e(){return a.getExperimentName()}function g(){return a.getAdditionalWeblabAndTreatmentMap()}function h(){return"C"===b()}function k(){var a=c.get(c.KEYS.NO_PREFETCH_EXPERIMENT_WEBLABS);
return Array.isArray(a)&&-1!==a.indexOf(e())&&!h()}return{getAllocation:b,getExperimentName:e,getAdditionalWeblabAndTreatmentMap:g,getHoldbackSecondaryPanelsWeblab:function(){return a.getHoldbackSecondaryPanelsWeblab()},isControl:h,isBuyNowOnly:function(){return b()===c.get(c.KEYS.BUY_NOW_ONLY_TREATMENT)},isDisableTurboWeblabInTreatment:function(){for(var a=g(),b=["RCX_CHECKOUT_DISABLE_TURBO_FOR_NPA_EXPERIMENT_543201","RCX_CHECKOUT_DISABLE_TURBO_FOR_PRIME_MOBILE_EXPERIMENT_601969","RCX_CHECKOUT_DISABLE_TURBO_FOR_PRIME_DESKTOP_EXPERIMENT_601976"],
c=0;c<b.length;c++){var d=b[c];if(d in a&&"T1"===a[d])return!0}return!1},isPrefetch:function(){return!k()&&b()===c.get(c.KEYS.PREFETCH_TREATMENT)},isNoPrefetch:function(){var a=c.get(c.KEYS.NO_PREFETCH_TREATMENT);return k()||!!b().match(a)}}});"use strict";f.when("A","jQuery","turbo-checkout-ajax-wrapper","turbo-checkout-utils","turbo-checkout-urls","turbo-checkout-csm","turbo-checkout-weblab-allocation","turbo-checkout-buy-now-button","turbo-checkout-form","turbo-configuration","turbo-checkout-state-handler",
"turbo-checkout-eligibility-response-weblabs","turbo-checkout-eligible-state","turbo-checkout-page-ready").register("turbo-checkout-weblab-trigger",function(d,a,c,b,e,g,h,k,l,f,n,q,r){function m(){d.on("turbo:checkout:prefetch:onTurboEligible",function(){E=!0;z()})}function v(){d.on("turbo:checkout:prefetch:onTurboIneligible",function(){E=!1;z()})}function u(){d.on("a:pageUpdate",function(){z()})}function w(){d.on("turbo:checkout:auto:open",function(){F()})}function z(){0===t().length?g.logCount("turboCheckoutBuyNowButtonMissing"):
0===l.getForms(t()).length&&g.logCount("turboCheckoutBuyNowFormMissing");0<l.getForms(t()).length&&(E?(b.logDebug("turbo-checkout-weblab-trigger","Adding trigger to form: "+h.getAllocation()),C.val(h.getAllocation()),x.val(h.getExperimentName()),B.val(n.getRequestId()),G.val(n.getSessionId()),l.getForms(t()).append(C,x,B,G)):(b.logDebug("turbo-checkout-weblab-trigger","Removing trigger from form: "+h.getAllocation()),C.remove(),x.remove(),B.remove(),G.remove()))}function t(){var b=f.get(f.KEYS.BUY_NOW_BUTTON_SELECTOR),
c=f.get(f.KEYS.BUY_NOW_BUTTON_V2_SELECTOR);return 0===a(b).length?a(c):a(b)}function A(){if(q.get()&&0<q.get().length||E&&!n.isTurboLaunched()){b.logDebug("turbo-checkout-weblab-trigger","Calling cheetah to trigger: "+h.getAllocation());0<l.getForms(t()).find(C).length||g.logCount("turboCheckoutTriggerMissing");var a=!E||n.isTurboLaunched()?e.buildTriggerWeblabPathWithoutWeblab(n.getRefTag,n.getRequestId(),n.getSessionId()):e.buildTriggerWeblabPathWith(n.getRefTag(),h.getExperimentName(),h.getAllocation(),
n.getRequestId(),n.getSessionId());if(E&&!n.isTurboLaunched()&&r.canShow()){var c=h.getAdditionalWeblabAndTreatmentMap();var d=[],k;for(k in c)c.hasOwnProperty(k)&&d.push({weblabName:k,weblabAllocation:c[k]});c=d}else c=[];F(a,c)}}function F(b,c){c=[].concat(c).concat(q.get());c={additionalWeblabsToTrigger:JSON.stringify(c)};var d="function"===typeof p.Blob;"function"===typeof p.navigator.sendBeacon&&d?(c=new Blob([a.param(c)],{type:"application/x-www-form-urlencoded"}),p.navigator.sendBeacon(b,c)||
g.logCount("turboCheckoutTriggerRecordingFailed")):D(b,c)}function D(a,b){c.load(a,{method:"POST",params:b,error:function(a,b,c){a&&204===a.http.status||g.logCount("turboCheckoutTriggerRecordingFailed")},abort:function(a){g.logCount("turboCheckoutTriggerRecordingFailed")}})}var C,x,B,G,E=!1;return{setup:function(){C=a("\x3cinput/\x3e",{type:"hidden",name:"triggerTurboWeblab",value:""});x=a("\x3cinput/\x3e",{type:"hidden",name:"triggerTurboWeblabName",value:""});B=a("\x3cinput/\x3e",{type:"hidden",
name:"turboPageRequestId",value:""});G=a("\x3cinput/\x3e",{type:"hidden",name:"turboPageSessionId",value:""});u();m();v();k.registerOnClickCallback(A);w()}}});"use strict";f.when("A","turbo-checkout-form","turbo-checkout-utils","turbo-checkout-state-handler","turbo-checkout-page-ready").register("turbo-checkout-page-filter",function(d,a,c,b){function e(a,b){c.logDebug("turbo-checkout-page-filter",a,b)}return{isCurrentViewTurboEligible:function(){var c=d.$(b.getInitiateSelector()),h=a.getForms(c),
k=0<c.length&&c.length===h.length;k||(e("Page is NOT turbo eligible. Parent forms / nested links do not match the number of initiate selectors",c),e("Forms",h));return k}}});"use strict";f.when("turbo-configuration","turbo-checkout-page-ready").execute("turbo-device-filter-check",function(d){d.get(d.KEYS.IS_DEVICE_FILTER_REQUIRED)||f.when("turbo-checkout-cacher","turbo-checkout-page-ready").register("turbo-checkout-device-filter",function(a){var c=function(){return!0};return{isDeviceTurboEligible:a.createCache(c),
isSignInSupported:a.createCache(c)}})});"use strict";f.when("A","turbo-checkout-state-handler","turbo-checkout-device-filter","turbo-checkout-page-filter","turbo-checkout-weblab-allocation","turbo-checkout-page-ready").register("turbo-checkout-eligibility-aggregator",function(d,a,c,b,e){return{isTurboEligible:function(){return b.isCurrentViewTurboEligible()&&a.isProductTurboEligible()&&!e.isBuyNowOnly()},isSignInSupported:function(){return c.isSignInSupported()&&!e.isBuyNowOnly()},shouldAttemptPrefetch:function(){return c.isDeviceTurboEligible()&&
!e.isBuyNowOnly()}}});"use strict";f.when("A","turbo-checkout-ref-tagger","turbo-filtered-callback-list","turbo-checkout-state-handler","turbo-checkout-ajax-wrapper","turbo-checkout-utils","turbo-checkout-urls","turbo-checkout-csm","turbo-checkout-eligibility-aggregator","turbo-checkout-eligibility-response-weblabs","turbo-checkout-accessories-input","turbo-checkout-page-ready").register("turbo-checkout-content-loader",function(d,a,c,b,e,g,h,k,f,m,n){function l(c){k.logCount("turboCheckoutInitiate");
F();E=!1;G=Date.now();u("Notifying loading callbacks");B="started";N.callAll();d.trigger("turbo:checkout:prefetch:onStart");k.logCount("turboCheckoutPrefetchStart");var g=c?[]:b.getLineItems(),f=c?a.generateEligibilityValue():b.getRefTag();g=(c?h.buildEligibilityPathWith:h.buildInitiatePathWith)(f,b.getExperimentName(),b.getClientId(),b.getRequestId(),b.getSessionId(),g);x=e.loadWithJQXHR(g,{type:"POST",data:r(c),headers:y(),xhr:v,success:K,error:t})}function r(a){var c={isAsync:1};b.getAddressId()&&
(c.addressID=b.getAddressId());b.isPhysicalGiftCardExperimentEligible()&&(c.isPhysicalGiftCard=!0);if(a&&n.isEligible()&&n.getLineItem()){var d=n.getLineItem();c["offerListing.1"]=d.offerListingId;c["requiresEligibilityCheck.1"]="true"}a||b.getLineItems().forEach(function(a,b){b+=1;c["offerListing."+b]=a.offerListingId;c["quantity."+b]=a.quantity;a.incentivizedCart&&(c["incentivizedCart."+b]=a.incentivizedCart,c.incentivizedCart=a.incentivizedCart);a.customItemPrice&&(c["customItemPrice."+b]=a.customItemPrice,
c.customItemPrice=a.customItemPrice);var d=a.addToCartTimeAsUnixEpochMilliseconds;d&&(c["addToCartTimeAsUnixEpochMilliseconds."+b]=d);(a=a.addToCartSessionId)&&(c["addToCartSessionId."+b]=a)});return c}function y(){var a={"x-amz-support-custom-signin":1};a["x-amz-turbo-checkout-dp-url"]=p.location.href;a["x-amz-checkout-entry-referer-url"]=p.location.href;var c=b.getCSRFToken();c&&0<c.length&&(a["x-amz-checkout-csrf-token"]=c);return a}function v(){var a=e.createXHRRequest();a.addEventListener("readystatechange",
function(){if(E||!a.readyState||2>a.readyState)u("Ignoring ready state changed event because headers already received or missing xhr");else if(E=!0,k.logCount("turboCheckoutPrefetchHeadersReceived"),k.logCount("turboCheckoutPrefetchHeadersReceivedDuration",Date.now()-G),a&&a.getResponseHeader("x-amz-turbo-checkout-eligible")){u("Headers received: Turbo eligible");k.logCount("turboCheckoutTurboEligibleAfterCheetahChecks");var b=a&&a.getResponseHeader("x-amzn-checkout-login-required"),c=f.isSignInSupported();
b&&(u("Headers received: Signin required"),k.logCount("turboCheckoutSigninRequired"),c||(u("Sign-in required but it is disabled or not supported."),k.logCount("turboCheckoutSigninNotSupported")));if(c||!b)u("Notifying turbo eligible callbacks"),Q.callAll(),d.trigger("turbo:checkout:prefetch:onTurboEligible");w(a)&&I.callAll(a.getResponseHeader("x-amzn-checkout-login-provider"))}else u("Headers received: Not turbo eligible"),P.callAll(),d.trigger("turbo:checkout:prefetch:onTurboIneligible")});return a}
function u(a,b){g.logDebug("turbo-checkout-content-loader",a,b)}function w(a){return f.isSignInSupported()&&a&&a.getResponseHeader("x-amzn-checkout-login-required")}function K(a,b,c){k.logCount("turboCheckoutPrefetchEnd",Date.now()-G);x=null;b=c&&c.getResponseHeader("x-amz-turbo-checkout-eligible");var e=a&&a.match(D);if(e&&0<e.length)try{var h=C(e[0]);var f=C.parseJSON(h.text())}catch(L){g.logError("Could not extract page state from cheetah page: "+L)}else u("Could not extract page state from response data");
h=f&&"turbo"===f.pipelineType;e=f&&f.currentPurchaseId&&0<String(f.currentPurchaseId).trim().length;var l=c.getResponseHeader("x-amzn-experiment-weblabs-to-trigger");if(l!==z){var n=[];try{n=JSON.parse(l)}catch(L){console.error("Error parsing additional weblabs from xhr response header: ",L)}m.set(n)}h&&!e&&g.logError("No purchaseid provided, cannot show turbo");b&&h&&e?("started"!==B&&g.logError("turbo-checkout-content-loader","Error processing turbo available callbacks. Expected state to be started but was "+
B),u("Notifying turbo available callbacks"),B="success",O.callAll(a,f),d.trigger("turbo:checkout:prefetch:onSuccess"),k.logCount("turboCheckoutTurboPrefetchSuccess")):b&&w(c)?u("Body received: Eligible and sign-in is supported and required."):(u("Body received: No turbo page or not eligible: isTurboEligible: "+b+" isTurboPage: "+h+" hasPurchaseId: "+e),A(),k.logCount("turboCheckoutTurboPrefetchFail"))}function t(a,b,c){k.logCount("turboCheckoutPrefetchEnd");x=null;u("Error while initiate",c);k.logCount("turboCheckoutTurboPrefetchError");
"timeout"===b&&k.logCount("turboCheckoutInitiateTimeOut");A()}function A(){"started"!==B&&g.logError("turbo-checkout-content-loader","Error processing turbo not available callbacks. Expected state to be started but was "+B);u("Notifying error callbacks");B="error";U.callAll();d.trigger("turbo:checkout:prefetch:onError")}function F(){x&&x.abort&&(u("Aborting running request..."),x.abort())}var D=/<script.*data-a-state.*checkout:conductor:page.*>.*<\/script>/,C=d.$,x,B="stopped",G,E=!1,N=c.create("onStart"),
O=c.create("onFinish"),U=c.create("onError"),Q=c.create("onTurboEligible"),P=c.create("onTurboIneligible"),I=c.create("onSigninRequired");d.on("turbo:checkout:signInController:onDoSignIn",A);return{registerCallback:function(a){N.push(a);O.push(a);U.push(a);Q.push(a);I.push(a);P.push(a)},callInitiate:function(){u("Calling turbo initiate");l()},checkEligibility:function(){u("Calling turbo eligibility check only");l(!0)},abortCall:F,isSuccess:function(){return"success"===B},isError:function(){return"error"===
B},isStarted:function(){return"started"===B}}});"use strict";f.when("A","jQuery","turbo-checkout-ref-tagger","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-history-manager",function(d,a,c,b){function e(){if(p.history.state&&p.history.state.turboAction)return p.history.state.turboAction}function g(){e();e()||(b.logDebug("turbo-checkout-history-manager","Adding turbo history state"),p.history.pushState({turboAction:"popover"},document.title+" Turbo open"))}var h=!1;a(p).bind("popstate.turbo",
function(a){e();h?(b.logDebug("turbo-checkout-history-manager","Trigger Subpanel Back Clicked"),d.trigger("turbo:checkout:dimmer:clicked"),h=!1,g()):e()?(b.logDebug("turbo-checkout-history-manager","Trigger sheet open"),d.trigger("turbo:checkout:sheet:doOpen")):(b.logDebug("turbo-checkout-history-manager","Trigger sheet close"),d.trigger("turbo:checkout:sheet:doClose",{immediate:!1,reason:c.TAGS.BACK}))});return{sheetOpened:g,sheetClosed:function(){e();e()&&(b.logDebug("turbo-checkout-history-manager",
"Removing turbo history state"),p.history.back())},subPanelOpened:function(){h=!0},subPanelClosed:function(){h=!1}}});"use strict";f.when("A","turbo-checkout-page-ready").register("turbo-base-visibility-manager",function(d){function a(){d.trigger("turbo:checkout:page:gone")}return{setup:function(){d.on("turbo:checkout:sheet:onNavigateAway",a)}}});f.when("turbo-configuration","turbo-checkout-page-ready").execute("turbo-mash-will-reappear-check",function(d){d.get(d.KEYS.USES_MASH_WILL_REAPPEAR)||f.when("turbo-base-visibility-manager").register("turbo-checkout-page-visibility-manager",
function(a){return a})});"use strict";f.when("A","jQuery","turbo-checkout-view-state","turbo-checkout-weblab-allocation","turbo-checkout-state-handler","turbo-checkout-content-loader","turbo-checkout-prefetch-timer","turbo-checkout-page-visibility-manager","turbo-checkout-counter","turbo-checkout-utils","turbo-checkout-eligibility-aggregator","turbo-checkout-auto-open","turbo-checkout-page-ready").register("turbo-checkout-prefetcher",function(d,a,c,b,e,g,h,k,f,m,n,p){function l(a){var b=v;v=a;m.logDebug("turbo-checkout-prefetcher",
"Transitioning from "+b.name+" to "+a.name);if(b.onExit)b.onExit(a.name);if(a.onEnter)a.onEnter(b.name);d.trigger("turbo:checkout:prefetcher:state:"+a.name);d.trigger("turbo:checkout:prefetcher:state",a.name)}var y,v,u=function(){var a=g.isError(),b=!n.isTurboEligible(),c=h.isTimeout(),d=0===y;m.logDebug("turbo-checkout-prefetcher","Test is data stale: isStaleWhenCheetahReturnsError: "+a+" isStaleWhenProductNotEligiblie: "+b+" isStaleWhenTimeoutOccurs: "+c+" isStaleWhenNoMorePrefetchesAvailable: "+
d);return a||b||c||d},w=function(){var a=n.isTurboEligible()&&!h.isTimeout()&&0<y;m.logDebug("turbo-checkout-prefetcher","Test should prefetch: eligibilityAggregator.isTurboEligible(): "+n.isTurboEligible()+" !timer.isTimeout(): "+!h.isTimeout()+" _prefetchesAvailable: "+y);return a},q={name:"start",onEvent:function(a){n.shouldAttemptPrefetch()?"controller:onPageLoaded"===a&&l(t):l(D)},onExit:function(){e.startMonitoringPage()}},t={name:"dataStale",onEvent:function(a){"page:gone"!==a&&"prefetch:onError"!==
a&&"sheet:afterClose"!==a&&w()&&l(A)}},A={name:"dataPrefetching",onEnter:function(){f.incrementPrefetchCounter();b.isPrefetch()||c.isOpeningOrOpen()||p.isAutoOpenReadyToBeOpened()?g.callInitiate():g.checkEligibility();--y},onEvent:function(a){if("page:gone"===a)l(t);else{var c=g.isSuccess()&&b.isPrefetch(),d=g.isSuccess()&&b.isNoPrefetch();m.logDebug("turbo-checkout-prefetcher","Test is data fresh: isFreshWhenPrefetchResultOKInT1: "+c+" isFreshWhenPrefetchResultOKInT4: "+d);c||d?l(z):u()?l(t):"product:onChange"===
a&&w()&&l(A)}},onExit:function(a){"dataFresh"!==a&&g.abortCall()}},z={name:"dataFresh",onEnter:function(){h.startTimer()},onEvent:function(a){"page:gone"===a?l(t):u()?l(t):(c.isClosed()||"product:onChange"===a)&&w()&&l(A)},onExit:function(){h.resetTimer()}},D={name:"end"},C="controller:onPageLoaded sheet:beforeOpen sheet:afterClose product:onChange prefetch:onSuccess prefetch:onError timer:onTimeout page:gone page:reappear".split(" "),x={"sheet:beforeOpen":function(){y=10}};return{setup:function(){y=
10;v=q;a.each(C,function(a,b){var c=x[b];d.on("turbo:checkout:"+b,function(a){m.logDebug("turbo-checkout-prefetcher","Processing "+b);c&&c();if(v.onEvent)v.onEvent(b)})})},getState:function(){return v.name}}});"use strict";f.when("A","turbo-signin-adapter","turbo-checkout-content-loader","turbo-checkout-buy-now-button","turbo-checkout-csm","turbo-checkout-weblab-allocation","turbo-checkout-utils","turbo-callback-list","turbo-checkout-state-handler","turbo-checkout-eligible-state","turbo-checkout-page-ready").register("turbo-checkout-signin-controller",
function(d,a,c,b,e,g,h,k,f,m){function l(){w=!1}function p(a){w=!0;z=a;e.logCount("turboCheckoutSigninRequired")}function r(){var b=w&&m.canShow();b&&(h.logDebug("turbo-checkout-signin-controller","Showing sign in dialog"),e.logCount("turboCheckoutSigninPopup"),a.show(z,y,v),d.trigger("turbo:checkout:signInController:onDoSignIn"));return b}function y(){h.logDebug("turbo-checkout-signin-controller","Signin success");e.logCount("turboCheckoutSigninSuccess");u.callAll()}function v(){h.logDebug("turbo-checkout-signin-controller",
"Signin failed");e.logCount("turboCheckoutSigninFailed")}var u=k.create(),w=!1,z;return{setup:function(){c.registerCallback({onStart:l,onSigninRequired:p});b.registerOnClickCallback(r)},registerCallback:u.push}});"use strict";f.when("A","turbo-configuration","turbo-callback-list","turbo-filtered-callback-list","turbo-checkout-page-ready").register("turbo-checkout-iframe",function(d,a,c,b){function e(){return d.$("#"+m)}function g(){if(!(0<e().length))throw"Attempted to read / write the iFrame without it being in the DOM. This would result in an undefined iFrame document.";
var a=e()[0];return a.contentDocument||a.contentWindow.document}function h(){if(0<e().length)throw"Attempted to insert multiple Turbo Checkout iFrames";}function k(){return d.$("\x3ciframe/\x3e",{id:m,src:"about:blank",scrolling:"no","class":"turbo-checkout-blank"})}function f(a){r.push(a)}var m=a.get(a.KEYS.IFRAME_ID),n=b.create("beforeFramePopulated"),p=b.create("afterFramePopulated"),r=c.create();f(function(a){a.addClass("turbo-checkout-shown")});d.on("turbo:checkout:iframe:document:loaded",function(){r.callAll(e())});
return{write:function(a){n.callAll();a+='\x3cscript\x3e"use strict";window.parent.P.now("turbo-checkout-controller").execute("callbackPageController", function callbackPageController(controller) {controller.frameHtmlRendered();});P.when("load").execute("onTurboDocumentLoaded", function onTurboDocumentLoaded() {window.parent.P.when("A").execute("triggerTurboDocumentLoaded", function triggerTurboDocumentLoaded(A) {A.trigger("turbo:checkout:iframe:document:loaded");});});\x3c/script\x3e';if("string"!==
typeof a)throw"Attempted to write non-string value to iFrame. typeof \x3d "+typeof a;var b=g();b.open();b.write(a);b.close();p.callAll(e()[0])},remove:function(){e().remove()},appendTo:function(a){h();a.append(k())},insertInto:function(a){h();a.html(k())},hasContent:function(){var a=0<e().length&&g();return a&&(a.body.hasChildNodes()||a.head.hasChildNodes())},registerCallbacks:function(a){n.push(a);p.push(a)},onContentLoaded:f}});"use strict";f.when("A","turbo-checkout-page-ready").register("turbo-checkout-view-state",
function(d){function a(a,b){return function(){return e===a||e===b}}function c(a){return function(){e=a;b.apply(b,arguments)}}function b(a,b){a&&"string"===typeof a&&d.trigger(a,b)}var e=0;return{isClosed:a(0),isClosing:a(1),isOpen:a(2),isOpening:a(3),isClosingOrClosed:a(1,0),isOpeningOrOpen:a(3,2),setToOpen:c(2),setToOpening:c(3),setToClosed:c(0),setToClosing:c(1)}});"use strict";f.when("A","turbo-view-adapter","turbo-checkout-view-state","turbo-checkout-eligible-state","turbo-checkout-content-loader",
"turbo-checkout-utils","turbo-checkout-weblab-allocation","turbo-checkout-weblab-trigger","turbo-checkout-csm","turbo-checkout-state-handler","turbo-checkout-device-filter","turbo-checkout-ajax-wrapper","turbo-checkout-page-visibility-manager","turbo-checkout-counter","turbo-checkout-prefetcher","turbo-checkout-prefetch-timer","turbo-checkout-buy-now-button","turbo-checkout-signin-controller","turbo-checkout-auto-open","turbo-checkout-urls","turbo-checkout-ref-tagger","turbo-configuration","turbo-checkout-event-verification",
"turbo-checkout-page-ready").register("turbo-checkout-controller",function(d,a,c,b,e,g,h,k,f,m,n,p,r,y,v,u,w,z,t,A,F,D,C){function l(){w.bindTurboClickEvent();d.off("turbo:checkout:dimmer:clicked");d.on("turbo:checkout:dimmer:clicked",function(a){a()})}function q(a,b){g.logDebug("turbo-checkout-controller",a,b)}function G(b,c){I();b||a.close({reason:c})}function E(){q("Handling signin success");O()}function N(){q("Handling buy now button click");O();return!0}function O(){V=setTimeout(K,2E4);J=f.createScope();
J.markClick();M="loading";S=!1;u.checkTimeout();y.incrementSheetOpenedCounter();a.show()}function K(){f.logCount("turboCheckoutContenLoadTimeout")}function Q(){I();a.removeContent()}function P(){I();C.logBuyNowButtonClickHandlerMetrics()}function I(){b.canShow()&&!h.isDisableTurboWeblabInTreatment()?(q("Registering with buy now button"),d.trigger("turbo:checkout:buyNowEnabled"),w.registerOnClickCallback(N)):(q("Unregistering from buy now button"),d.trigger("turbo:checkout:buyNowDisabled"),w.deregisterOnClickCallback(N))}
function X(b,c){f.logCount("turboCheckoutPrefetchSuccess");b&&(h.isControl()||h.isBuyNowOnly())&&(q("Received content in control: "+b.substring(0,255)),f.logCount("turboCheckoutControlContentReceived"));T=c;a.setContent(b);I()}function Y(){I();c.isOpeningOrOpen()&&(f.logCount("turboCheckoutYieldNewPurchase"),a.closeImmediatelyThenExecute(L))}function Z(){clearTimeout(V);M="unknown";!H||H.isResolved()||H.isRejected()||(q("Initiate confirm called for "+T.currentPurchaseId+" with existing confirm still executing. Aborting"),
f.logCount("turboCheckoutConfirmPending"),H._supersedByNewPurchase=!0,H.abort());ba()}function aa(){var a=m.getLineItems().filter(function(a){return a&&a.isDiscoveredAsin}).map(function(a,b){return a.asin});f.logCount("turboCheckoutDiscoveredAsins",a.length);return a}function ba(){f.logCount("turboCheckoutConfirm");var b=T.currentPurchaseId,c=A.buildConfirmPathWith(m.getRefTag(),h.getExperimentName(),m.getClientId(),m.getRequestId(),m.getSessionId(),aa());H=p.loadWithJQXHR(c,{type:"POST",data:{pid:b},
headers:ca(),success:function(a,b,c){f.logCount("turboCheckoutConfirmSuccess")},error:function(c,d,e){"abort"===d?f.logCount("turboCheckoutConfirmAborted"):("timeout"===d&&f.logCount("turboCheckoutConfirmTimeOut"),f.logCount("turboCheckoutConfirmFailed"));c._supersedByNewPurchase||(g.logError("Issue confirming turbo initiate prefetch for pid "+b+": "+e+", "+d),f.logCount("turboCheckoutYieldNewPurchase"),a.closeImmediatelyThenExecute(L))}})}function ca(){var a={},b=m.getCSRFToken();b&&0<b.length&&
(a["x-amz-checkout-csrf-token"]=b);return a}function da(){J.markFirstByte()}function R(){return D.get(D.KEYS.HOST_PAGE_TYPE_IDENTIFIER)}function L(){w.executeOriginalBuyNowAction(m.getActiveId())}function ea(a){d.trigger("turbo:checkout:embedded:page:showSpinner");H.done(a)}function fa(a,b,c){M=c;S=!1}function ha(){S=!0}function ia(a){d.off("turbo:checkout:dimmer:clicked");d.on("turbo:checkout:dimmer:clicked",function(a){a()});a&&a.doNotLog||(a&&!a.doNotLog?W(M,a.reason):W(M,!1));M="closed"}function W(a,
b){var c=A.buildLogPageHitPathWith(S?a+"2":a,b,m.getClientId());q("Logging page hit from "+a+" to "+R()+" reason "+b);p.load(c,{method:"POST",params:{pageType:R(),referrer:a},timeout:4E3})}function ja(){c.isOpeningOrOpen()&&f.logCount("turboCheckoutProductChangedWhileOpening")}var J,M,T,S;F=D.get(D.KEYS.AJAX_PAGE_UPDATE_EVENT);var V,H;d.on(F,l);l();return{pageLoaded:function(){var c=h.getExperimentName();if(c){var g=h.getAllocation();f.addCounterExtraSuffix("wl:"+g);f.addCounterExtraSuffix(c+":"+
g)}n.isDeviceTurboEligible()&&(b.setup(),b.registerStateChangeCallback(G),r.setup(),e.registerCallback({onStart:Q,onTurboEligible:P,onFinish:X,onError:Y}),k.setup(),z.setup(),z.registerCallback(E),J=f.createScope(),a.registerCallbacks({beforeFramePopulated:Z,afterFramePopulated:da}),m.registerCallback(ja),d.on("turbo:checkout:sheet:beforeClose",ia),d.on("turbo:checkout:embedded:page:beforeReload",fa),d.on("turbo:checkout:embedded:page:animation:start",ha),t.setup(w.executeTurboBuyNowAction,P),v.setup(),
d.trigger("turbo:checkout:controller:onPageLoaded"))},loadFullscreen:function(b,c){function d(){b=g.createFQDN(b);"thankyou"===c?(f.logCount("turboCheckoutYieldTYP"),"primewardrobe"===m.getClientId()&&f.logCount("turboCheckoutYieldTYP:pw"),a.closeAndNavigate(b)):"thirdPartyPaymentInterstitial"===c?a.closeAndNavigate(b):"verifyMfaPage"===c?("primewardrobe"===m.getClientId()&&f.logCount("turboCheckoutYieldTYP:pw"),a.closeAndNavigate(b)):(f.logCount("turboCheckoutYield"),a.closeToFullscreen(b))}!H||
H.isResolved()||H.isRejected()?d():(f.logCount("turboCheckoutWaitYield"),ea(d))},frameContentReady:function(a,b,c){d.trigger("turbo:checkout:embedded:page:ready",a,b);(function(){var a=function(){J.markCriticalFeature();c.confirmHit(R(),m.getRefTag());J.whenDataSet(c.recordClientSideMetrics);b.off("checkout:afterReload",a)};b.on("checkout:afterReload",a)})();(function(){b.on("checkout:beforeReload",function(c){d.trigger("turbo:checkout:embedded:page:beforeReload",a,b,c)});b.on("checkout:reload",function(c){d.trigger("turbo:checkout:embedded:page:reload",
a,b,c)});b.on("checkout:afterReload",function(c){d.trigger("turbo:checkout:embedded:page:afterReload",a,b,c)});b.on("turbo:checkout:animation:start",function(){d.trigger("turbo:checkout:embedded:page:animation:start")});b.state("turbo-secondary-panels-weblab-state",h.getHoldbackSecondaryPanelsWeblab());d.on("turbo:checkout:embedded:page:showSpinner",function(){c.showSpinner()});d.off("turbo:checkout:dimmer:clicked");d.on("turbo:checkout:dimmer:clicked",function(a){b.trigger("turbo:checkout:dimmer:clicked:iFrame",
a)});b.on("turbo:checkout:update:dimmer",function(a){d.trigger("turbo:checkout:update:dimmer:afterReload",a)});b.on("turbo:checkout:update:modal:header",function(a){d.trigger("turbo:checkout:update:modal:header:afterReload",a)});b.on("turbo:checkout:update:dimmer:block",function(){d.trigger("turbo:checkout:update:dimmer:block:iFrame")});b.on("turbo:checkout:update:dimmer:unblock",function(){d.trigger("turbo:checkout:update:dimmer:unblock:iFrame")})})()},frameHtmlRendered:function(){J.markAboveTheFold()},
updateBounds:function(b,c){a.updateBounds(b,c)},getHeight:function(){return a.getHeight()},updateMinHeight:function(b){return a.updateMinHeight(b)},updateScrollHeight:function(b,c){return a.updateScrollHeight(b,c)},updateDimmer:function(a){d.trigger("turbo:checkout:update:dimmer:typReload",a)},getHostPageType:R}});"use strict";f.when("turbo-checkout-page-load-spinner","turbo-checkout-controller","turbo-checkout-csm","turbo-checkout-page-state","turbo-constants","turbo-checkout-page-ready").register("turbo-checkout-startup",
function(d,a,c,b,e){b.get().turboAssetsMode!==e.ASSET_MODE_CLT_CX_ONLY&&(d.removePageLoadSpinner(),c.logCount("turboCheckoutControllerPageLoaded"),a.pageLoaded())});"use strict";f.when("turbo-checkout-assets-load-trigger").register("turbo-checkout-page-ready",function(){p.ue&&p.ue.count&&"undefined"!==typeof p.ue_t0&&p.ue.count("turboCheckoutPageReady",Date.now()-p.ue_t0)});"use strict";f.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-state-handler","turbo-checkout-quantity-input",
"turbo-checkout-warranty-input","turbo-checkout-accessories-input","turbo-checkout-page-ready").register("turbo-checkout-authportal-return-query",function(d,a,c,b,e,g,f){function h(a){c.logDebug("turbo-checkout-authportal-return-query",a)}function l(a){return!!a.match("trb_auth\x3d1")}function m(d){if(l(d)){d=((d||"").match(r)||[])[1]||"";var e=b.getSessionId();c.isNonEmptyString(d)||a.logCount("turboCheckoutPostAuthEmptySessionParameter");c.isNonEmptyString(e)||a.logCount("turboCheckoutPostAuthEmptySessionPageState");
c.isNonEmptyString(d)&&c.isNonEmptyString(e)&&d!==e&&(c.logWarning("Turbo Session Flip Detected. Post authentication sessionId \x3d "+e+", Expected \x3d "+d,"turbo-checkout-authportal-return-query"),a.logCount("turboCheckoutPostAuthSessionFlip"))}}var n=/&?(openid|aToken|serial)[^&]*/g,q=/&?trb_(open|auth|qty|warrAsin|sid|accessory(Asin|Offer))=[^&]*/g,r=/&?trb_sid=([^&]*)/,y=/\?[?&]*/,v=/[?&]{2,}/g;m(p.location.search);return{buildFrom:function(a){h("Initial Query \x3d "+a);a=(a||"?").replace(n,
"");a=a.replace(q,"");a+="\x26trb_auth\x3d1\x26trb_open\x3d1";var c=e.getQuantity();a+=1<c?"\x26trb_qty\x3d"+c:"";c=g.getLineItem();a+=c&&c.asin?"\x26trb_warrAsin\x3d"+c.asin:"";c=b.getSessionId();a+=0<c.length?"\x26trb_sid\x3d"+c:"";c=b.getActiveId();a+=c?"\x26trb_bid\x3d"+c:"";c=f.getLineItem();a+=c&&c.asin&&c.offerListingId?"\x26trb_accessoryAsin\x3d"+c.asin+"\x26trb_accessoryOffer\x3d"+c.offerListingId:"";a=a.replace(y,"?").replace(v,"\x26");h("Final Query \x3d "+a);return a},isReturningFromAuthPortal:l,
validateSession:m}});"use strict";f.when("turbo-checkout-utils","turbo-checkout-csm","turbo-checkout-authportal-return-query","turbo-checkout-page-ready").register("turbo-checkout-signin-utils",function(d,a,c){function b(a){return null!==a.match(g)}function e(){var a=c.buildFrom(p.location.search);return encodeURIComponent("https://"+p.location.hostname+p.location.pathname.replace(f,"/ref\x3dtrb_chk_auth")+a)}var g=/openid\.return_to=([^&$]+)/,f=/(\/ref=[^/]*\/?$|\/?$)/;return{encodeSignInUrl:function(c){if(b(c)){a.logCount("turboCheckoutForceMobileClaimCollection");
var f=c.match(g)[1],h=decodeURIComponent(f);f===h&&d.logError("The pre-defined returnTo seems to be un-encoded");h=encodeURIComponent(h+(-1===h.indexOf("?")?"?":"\x26")+"openid.return_to\x3d"+e());return c.replace(f,h)}return c+(-1===c.indexOf("?")?"?":"\x26")+"openid.return_to\x3d"+e()},isEnforceMobileClaimUrl:function(a){var b=null!==a.match("openid.pape.preferred_auth_policies%3DEnforcePossessionOnMobileClaim")||null!==a.match(decodeURIComponent("openid.pape.preferred_auth_policies%3DEnforcePossessionOnMobileClaim"));
a=null!==a.match("intercept%3Dfalse")||null!==a.match(decodeURIComponent("intercept%3Dfalse"));return b&&a},_isReturnToParameterPredefined:b}});"use strict";f.when("turbo-checkout-utils","turbo-checkout-csm","turbo-checkout-auto-open","turbo-checkout-authportal-return-query","turbo-checkout-signin-utils","turbo-checkout-page-ready").register("turbo-checkout-browser-signin",function(d,a,c,b,e){function g(){var b=p.location.search.match(f)?"turboCheckoutSigninSuccess":"turboCheckoutSigninFailed";a.logCount(b)}
var f=/openid\.mode=id_res/;b.isReturningFromAuthPortal(p.location.search)&&(a.logCount("turboCheckoutAuthPortalReturn"),g());return{show:function(b){b=e.encodeSignInUrl(b);a.logCount("turboCheckoutSignInUrlSize",b.length);c.reset();p.location.assign(b)}}});"use strict";f.when("turbo-checkout-utils","turbo-checkout-state-handler","turbo-checkout-page-ready").register("turbo-checkout-strings",function(d,a){function c(b){return function(){var c=a.getStrings()[b];if(c)return d.escapeHtml(c);d.logDebug("turbo-checkout-strings",
'String for key "'+b+'" is undefined! Returning empty string.');return""}}return{getHeaderText:c("TURBO_CHECKOUT_HEADER"),getLoadingText:c("TURBO_LOADING_TEXT")}});"use strict";f.when("jQuery","turbo-checkout-page-ready").register("turbo-checkout-loading-spinner",function(d){function a(){return d("#turbo-loading-container")}function c(a){var b=d("\x3cdiv\x3e",{id:"turbo-loading-content"}).append(d("\x3cdiv\x3e",{id:"turbo-loading-spinner","class":"a-spinner a-spinner-medium"}));"string"===typeof a&&
a&&b.append(d("\x3cdiv\x3e",{id:"turbo-loading-text",text:a}));return b}return{create:function(a){return d("\x3cdiv\x3e",{id:"turbo-loading-container"}).append(c(a))},get:a,show:function(){a().addClass("turbo-checkout-shown")}}});"use strict";f.when("A","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-eligibility-response-weblabs",function(d,a){var c=[];return{set:function(a){d.$.isArray(a)&&(c=a)},get:function(){return c}}});"use strict";f.when("turbo-checkout-csm","turbo-checkout-utils",
"turbo-checkout-page-ready").register("turbo-checkout-session-storage",function(d,a){function c(b,c){a.logDebug("turbo-checkout-session-storage",b,c)}return{isPresent:function(a){a:{try{var b=p.sessionStorage.getItem(a);break a}catch(g){d.logCount("turboCheckoutSessionStorageExceptionGet"),c("get() exception",g)}b=null}return null!==b&&b!==z},set:function(a,e){try{p.sessionStorage.setItem(a,e)}catch(g){d.logCount("turboCheckoutSessionStorageExceptionSet"),c("set() exception",g)}},remove:function(a){try{return p.sessionStorage.removeItem(a)}catch(e){d.logCount("turboCheckoutSessionStorageExceptionRemove"),
c("remove() exception",e)}}}});"use strict";f.when("A","turbo-configuration","turbo-checkout-page-ready").register("turbo-checkout-load-events",function(d,a){var c=a.get(a.KEYS.AJAX_PAGE_UPDATE_EVENT);return{bind:function(a){d.off(c,a);d.off("turbo:checkout:controller:onPageLoaded",a);d.on(c,a);d.on("turbo:checkout:controller:onPageLoaded",a)}}});"use strict";f.when("A","jQuery","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-buy-now-button","turbo-configuration","turbo-checkout-page-ready").register("turbo-checkout-event-verification",
function(d,a,c,b,e,g){function f(){var a=g.get(g.KEYS.BUY_NOW_CLICK_EVENT).split(".");return 1<a.length?a[1]:"turboCheckout"}function k(a){var b=a.map(function(a){return a.namespace}).filter(function(a,b,c){return c.indexOf(a)===b});a.length!==b.length&&c.logCount("turboCheckoutBuyNowButtonDuplicateClickHandler")}function l(a){if((a=a.filter(function(a){return a!==z&&"click"===a.type&&0<=p.indexOf(a.namespace)}))&&0<a.length){var b=0;a.forEach(function(a){a.namespace!==f()&&(c.logCount("turboCheckoutBuyNowButtonClickHandlerWhitelisted:"+
a.namespace),b++)});0<b&&c.logCount("turboCheckoutBuyNowButtonClickHandlerWhitelistedQuantity:"+b)}}function m(a){if((a=a.filter(function(a){return a!==z&&"click"===a.type&&0>p.indexOf(a.namespace)}))&&0<a.length){var b=0;a.forEach(function(){c.logCount("turboCheckoutBuyNowButtonClickHandlerNotWhitelisted");b++});c.logCount("turboCheckoutBuyNowButtonClickHandlerNotWhitelistedQuantity:"+b)}}var n=!1,p=[f(),"accessoryUpsellInterstitial","makoPreRegistration","moq","siatc","hctpDFL","bbg","vasBuyNow",
"ppdBundles","makoGiftingMetrics","financialOptionsCheckout"];return{logBuyNowButtonClickHandlerMetrics:function(){var d=e.getBuyNowButtons();if(!n&&d&&0<d.length){for(var g=0;g<d.length;g++){var f=a._data(d[g],"events");if(!f||!f.click){c.logCount("turboCheckoutBuyNowButtonNoBoundHandlers");return}var h=(f=f.click)?f.length:0;1<h&&(b.logDebug("turbo-checkout-event-verification","Multiple handlers bound to 'click' in Buy Now button. Number of handlers: "+h,void 0),c.logCount("turboCheckoutBuyNowButtonMultipleClickEventsBound"),
c.logCount("turboCheckoutBuyNowButtonMultipleClickEventsBoundQuantity:"+h));k(f);m(f);l(f)}n=!0}}}});"use strict";f.when("turbo-checkout-page-ready").register("turbo-constants",function(){return{ASSET_MODE_TURBO_ONLY:"TURBO_ONLY",ASSET_MODE_CLT_CX_ONLY:"CLT_CX_ONLY",ASSET_MODE_TURBO_AND_CLT_CX:"TURBO_AND_CLT_CX"}});"use strict";f.when("turbo-checkout-state-handler","turbo-checkout-page-ready").register("turbo-shopping-portal-switch",function(d){return{isShoppingPortalEnabled:function(){var a=d.getClientId();
return!("primewardrobe"===a||"primestylist"===a)}}});"use strict";f.when("turbo-checkout-page-ready").register("turbo-tbyb-shopping-portal-switch",function(){return{isTBYBShoppingPortalEnabled:function(){return!1}}})});
/* ******** */
(function(k){var g=window.AmazonUIPageJS||window.P,v=g._namespace||g.attributeErrors,b=v?v("TurboCheckoutSharedMobileAssets",""):g;b.guardFatal?b.guardFatal(k)(b,window):b.execute(function(){k(b,window)})})(function(k,g,v){k.when("A","turbo-checkout-page-ready").register("turbo-checkout-scroll-stopper",function(b){function e(b,r){b=r.$;1===b("#turbo-checkout-select-form").length&&c(b)}function c(b){var c=b("#turbo-checkout-select-form");c.bind("touchstart",function(b){b=c[0].scrollHeight;var u=c.height(),
e=b-u;b>u&&(0>=c.scrollTop()&&c.scrollTop(1),c.scrollTop()>=e&&c.scrollTop(c.scrollTop()-1))});b("#checkout-page-container").bind("touchmove",function(c){var e=b("#turbo-checkout-select-form"),h=e[0].scrollHeight,q=e.height(),g=h-q;g=0<e.scrollTop()&&e.scrollTop()<g;h=h>q&&g;0!==e.has(c.target).length&&h||c.preventDefault()})}var h;b.on("turbo:checkout:embedded:page:ready",e);b.on("turbo:checkout:embedded:page:beforeReload",e);return{disablePageScrolling:function(c){c=b.$;h=c(document.body).css("overflow");
c(document.body).css("overflow","hidden")},restoreScrolling:function(c){c=b.$;c(document.body).css("overflow",h)}}});"use strict";k.when("A","turbo-callback-list","turbo-checkout-page-ready").register("turbo-checkout-orientation-listener",function(b,e){function c(){b.on("orientationchange",function(){h()})}function h(){var c=g();b.trigger("turbo:checkout:orientation:onChange",{orientation:c});k.callAll(c)}function g(){return r("html").hasClass("a-ws")?"landscape":"portrait"}var r=b.$,k=e.create();
return{startListening:function(){c();h()},registerCallback:k.push,getOrientation:g}});"use strict";k.when("A","turbo-checkout-iframe","turbo-checkout-view-state","turbo-checkout-base-view","turbo-checkout-scroll-stopper","turbo-checkout-history-manager","turbo-checkout-utils","turbo-checkout-mash-integration-adapter","turbo-checkout-ref-tagger","turbo-checkout-device-filter","turbo-checkout-strings","turbo-checkout-loading-spinner","turbo-configuration","turbo-checkout-page-ready").register("turbo-checkout-bottom-sheet",
function(b,e,c,h,k,r,E,u,F,G,M,w,H){function t(a,b){E.logDebug("turbo-checkout-bottom-sheet",a,b)}function q(){c.setToOpening("turbo:checkout:sheet:beforeOpen");u.dispatchEvent({type:"appOverlays.Hide"});y();I();N()}function y(){d||O();e.remove();d.html(w.create(M.getLoadingText()))}function O(){d=f("\x3cdiv/\x3e",{id:"turbo-checkout-bottom-sheet"});l=f("\x3cdiv/\x3e",{id:"turbo-checkout-bottom-sheet-dimmer"});m=f("\x3cspan/\x3e",{id:"turbo-checkout-bottom-sheet-dimmer-close"});l.append(m);f(document.body).append(d);
f(document.body).append(l);l.bind("touchmove",function(){return!1})}function I(){x&&(y(),w.show(),e.appendTo(d),k.disablePageScrolling(l),e.write(x))}function N(){var a=P();t("_animateShow() scrollPos \x3d "+a);n=f(g.document).scrollTop();t("_animateShow() _previousScrollPos \x3d "+n);z=f(document.body).css("top");t("_animateShow() _previousTopPos \x3d "+z);n!==a&&f("html, body").animate({scrollTop:a},400,function(){t("_animateShow() _setBodyTop \x3d "+-1*a);J(-1*a)});A(d,Q);d.addClass("turbo-checkout-bottom-sheet-visible").css({bottom:0});
d.css("overflow-y","");d.css("-webkit-overflow-scrolling","");l.css({width:"100%"}).addClass("turbo-checkout-bottom-sheet-dimmer-visible");r.sheetOpened()}function Q(){c.setToOpen();l.bind("click",B);m.bind("click",C);f(document.body).addClass("turbo-checkout-fix-body");w.show();"function"===typeof G.isAtleast_iOS_10_3&&G.isAtleast_iOS_10_3()&&f(d).hide().show(0)}function P(){var a=f(R);if(1===a.length)var b=a.offset().top;if(!b||1>b)b=1;return b}function J(a){f(document.body).css({top:a})}function p(a){function e(){c.setToClosed(x);
d.removeClass("turbo-checkout-no-animation");l.removeClass("turbo-checkout-no-animation");y()}function h(){z!==v&&J(z);var a=f(g.document).scrollTop();t("_resetScrollPosition() scrollTop \x3d "+a);a!==n&&(t("_resetScrollPosition() scrollTop !\x3d\x3d _previousScrollPos. Scrolling to y \x3d "+n),a=q?0:400,f("html, body").animate({scrollTop:n},a,function(){b.animationFrameDelay(function(){var a=f(g.document).scrollTop();a!==n&&(t("_resetScrollPosition() postAnimateScrollTop !\x3d\x3d _previousScrollPos | "+
a+" !\x3d "+n),f("html, body").scrollTop(n))})}))}var q=a&&a.immediate,p=a===v||a.notify===v||a.notify,w=p&&"turbo:checkout:sheet:beforeClose",x=p&&"turbo:checkout:sheet:afterClose";t("close() params",a);c.isOpeningOrOpen()&&(m.css("margin-bottom",""),d.css("height",""),m.css("bottom",""),c.setToClosing(w,a),u.dispatchEvent({type:"appOverlays.Show"}),k.restoreScrolling(l),f(document.body).removeClass("turbo-checkout-fix-body"),h(),q&&(d.addClass("turbo-checkout-no-animation"),l.addClass("turbo-checkout-no-animation")),
d.removeClass("turbo-checkout-bottom-sheet-visible"),l.removeClass("turbo-checkout-bottom-sheet-dimmer-visible"),l.unbind("click",B),m.unbind("click",C),m.removeClass("done-content"),r.sheetClosed(),A(d,e))}function K(a){var c=E.isAndroid();c&&d.addClass("turbo-checkout-bottom-sheet-fullscreen");A(d,function(e){p({notify:!1,immediate:!0,doNotLog:!0});c&&d.removeClass("turbo-checkout-bottom-sheet-fullscreen");b.trigger("turbo:checkout:sheet:onNavigateAway");a()})}function S(a){p({notify:!1,doNotLog:!0});
A(d,function(c){b.trigger("turbo:checkout:sheet:onNavigateAway");a()})}function A(a,c){a=L(a.css("transition-duration"))+L(a.css("transition-delay"));b.delay(c,a)}function L(a){var b=0;a&&(b=/ms$/.test(a)?parseFloat(a):1E3*parseFloat(a));return b}function B(){b.trigger("turbo:checkout:dimmer:clicked",function(){p({reason:F.TAGS.TOUCH})})}function C(){b.trigger("turbo:checkout:dimmer:clicked",function(){var a=m.hasClass("done-content")?F.TAGS.DONE:F.TAGS.TOUCH_X;p({reason:a})})}var R=H.get(H.KEYS.BACKGROUND_SCROLL_TARGET_SELECTOR),
f=b.$,x,d,l,m,n,z,D=new (h.extend())("#turbo-checkout-bottom-sheet");(function(){E.isIPhone()&&g.addEventListener("message",function(a){if(/.*\.amazon\.com/.test(a.origin)){if("turbo:checkout:virtualkeyboard:opened"===a.data){var b=d[0].getBoundingClientRect().bottom;d.css({bottom:-1*(g.innerHeight-b)})}"turbo:checkout:virtualkeyboard:closed"===a.data&&d.css({bottom:0})}})})();D.pushBoundsAdjustedCallback(function(a){m.css("bottom",a)});e.onContentLoaded(function(a){w.get().remove()});b.on("turbo:checkout:sheet:doOpen",
q);b.on("turbo:checkout:sheet:doClose",p);b.on("turbo:checkout:update:dimmer:afterReload",function(a){a?(f("#turbo-checkout-bottom-sheet-dimmer-close").attr("data-after",a),f("#turbo-checkout-bottom-sheet-dimmer-close").addClass("back-content"),r.subPanelOpened(),d.css("overflow-y","scroll"),d.css("-webkit-overflow-scrolling","touch")):(r.subPanelClosed(),f("#turbo-checkout-bottom-sheet-dimmer-close").removeClass("back-content"),d.css("overflow-y",""),d.css("-webkit-overflow-scrolling",""))});b.on("turbo:checkout:update:dimmer:typReload",
function(a){a&&(m.attr("data-after",a),m.addClass("done-content"))});b.on("turbo:checkout:update:dimmer:block:iFrame",function(){l.unbind("click",B);m.unbind("click",C)});b.on("turbo:checkout:update:dimmer:unblock:iFrame",function(){l.bind("click",B);m.bind("click",C)});return{show:q,setContent:function(a){x=a;c.isOpeningOrOpen()&&!e.hasContent()&&I()},removeContent:function(){x=null;y()},close:p,closeToFullscreen:function(a){K(function(){u.modalOpen(a)})},closeImmediatelyThenExecute:K,closeAndNavigate:function(a){S(function(){u.navigate(a)})},
registerCallbacks:function(a){e.registerCallbacks(a)},updateBounds:function(a,b,c){(c=c?c:f(g.top).height())&&(a=Math.min(a,c-m.height()));D.updateBounds(a,b)},getHeight:function(){return D.getHeight()},updateMinHeight:function(a){d.css("minHeight",a)},updateScrollHeight:function(a,b){D.updateScrollHeight(a,b)}}});"use strict";k.when("turbo-base-eligible-state","turbo-checkout-ref-tagger","turbo-checkout-orientation-listener").register("turbo-checkout-eligible-state",function(b,e,c){function h(b){"portrait"!==
c.getOrientation()&&b.invalidate("Landscape orientation")}function g(){b.onStateChange(e.TAGS.ROTATION)}return{canShow:b.canShow,registerStateChangeCallback:b.registerStateChangeCallback,setup:function(){b.setup();b.addStateCheck(h);c.registerCallback(g);c.startListening()}}});"use strict";k.when("turbo-configuration-keys","turbo-device-configuration","turbo-function-adapter","turbo-checkout-page-ready").execute("turbo-mash-integration-adapter-factory",function(b,e,c){k.when(e[b.MASH_ADAPTER]).register("turbo-checkout-mash-integration-adapter",
function(b){return{dispatchEvent:c.adapt(b.dispatchEvent),modalOpen:c.adapt(b.modalOpen),navigate:c.adapt(b.navigate),showLoginDialog:c.adapt(b.showLoginDialog),show:c.adapt(b.show)}})})});
/* ******** */
(function(b){var d=window.AmazonUIPageJS||window.P,e=d._namespace||d.attributeErrors,a=e?e("TurboCheckoutMobileWebAssets",""):d;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,d,e){b.when("turbo-checkout-page-ready").execute(function(){b.declare("turbo-device-override","Browser-SmartPhone")});"use strict";b.when("turbo-configuration-keys","turbo-device-override","turbo-checkout-page-ready").register("turbo-device-configuration",function(a,b){if(!c){var c={};
c[a.IS_DEVICE_FILTER_REQUIRED]=!1;c[a.USES_MASH_WILL_REAPPEAR]=!1;c[a.SHOW_SIGN_IN_INTERFACE]="turbo-checkout-browser-signin";c[a.IFRAME_ID]="turbo-checkout-bottom-sheet-frame";c[a.EXTEND_ELIGIBLE_STATE]=!0;c[a.VIEW_ADAPTER]="turbo-checkout-bottom-sheet";c[a.DEVICE_OVERRIDE]=b;c[a.MASH_ADAPTER]="turbo-checkout-mash-facade"}return c});"use strict";b.when("turbo-checkout-page-ready").register("turbo-checkout-mash-facade",function(){function a(a){d.location.href=a}function b(){throw"Unsupported method. Interface exists to preserve legacy interface.";
}return{navigate:a,modalOpen:a,dispatchEvent:function(){},showLoginDialog:b,show:b}})});
/* ******** */
(function(c){var d=window.AmazonUIPageJS||window.P,e=d._namespace||d.attributeErrors,a=e?e("CartTurboCheckoutAssets@CommonTango","CartTurboCheckoutAssets"):d;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,d,e){"use strict";c.when("A","turbo-checkout-csm","turbo-checkout-load-events","tango-checkout-urls","tango-checkout-eligibility","turbo-checkout-page-ready").register("cart-tango-checkout",function(a,b,d,e,f){function g(){f.isEligibleFromPageState()?(f.setEligibleCallback(k),
f.setIneligibleCallback(l),f.checkEligibility()):(f.setTangoPageStateUrl(""),b.logCount("tangoCheckoutCartNotEligible"))}function k(){var a=e.buildProceedToCheckoutPathWithParams();f.setTangoPageStateUrl(a)}function l(){h()}function h(){c.when("ready").execute(function(){var b=a.$("#checkout-url-weblab-migration-status");if(b.length){var c=b.val();0<=c.indexOf("_not_eligible_customer")||b.val(c+"_not_eligible_customer")}})}e.setRefMarkerPageContext("sc");g();d.bind(g);a.on("turbo:checkout:page:reappear",
g);return{_forTestingOnly:{_setTangoWeblabStatusCSMTagValueAsIneligible:h}}});"use strict";c.when("turbo-configuration-keys","turbo-checkout-page-ready").register("turbo-client-configuration",function(a){if(!b){var b={};b[a.HOST_PAGE_TYPE_IDENTIFIER]="cart";b[a.NO_PREFETCH_TREATMENT]="T1";b[a.IS_ADD_TO_CART_ENABLED]=!1;b[a.TURBO_PRODUCT_STATE_KEY]="turbo-checkout-product-state";b[a.FORM_SELECTOR_OVERRIDE]="#sc-proceed-to-checkout-params-form";b[a.CHECKBOX_EXCLUSION_ROOT_NODES]=[".sc-gift"];b[a.AJAX_PAGE_UPDATE_EVENT]=
"sc:ajaxupdate:complete";b[a.BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID]=".checkout-buy-now"}return b})});
/* ******** */
